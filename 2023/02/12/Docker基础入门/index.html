<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Docker基础入门 | QianChengGitの小森林</title><meta name="keywords" content="Docker"><meta name="author" content="QianChengGit"><meta name="copyright" content="QianChengGit"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="学习Docker的使用。">
<meta property="og:type" content="article">
<meta property="og:title" content="Docker基础入门">
<meta property="og:url" content="http://qianchenggit.github.io/2023/02/12/Docker%E5%9F%BA%E7%A1%80%E5%85%A5%E9%97%A8/index.html">
<meta property="og:site_name" content="QianChengGitの小森林">
<meta property="og:description" content="学习Docker的使用。">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://i.loli.net/2021/03/07/HoXI7C2NtdguaBw.jpg">
<meta property="article:published_time" content="2023-02-12T20:50:00.000Z">
<meta property="article:modified_time" content="2023-02-12T20:50:00.000Z">
<meta property="article:author" content="QianChengGit">
<meta property="article:tag" content="Docker">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://i.loli.net/2021/03/07/HoXI7C2NtdguaBw.jpg"><link rel="shortcut icon" href="/img/avatar.png"><link rel="canonical" href="http://qianchenggit.github.io/2023/02/12/Docker%E5%9F%BA%E7%A1%80%E5%85%A5%E9%97%A8/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: {"defaultEncoding":2,"translateDelay":100,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  noticeOutdate: {"limitDay":90,"position":"top","messagePrev":"此文章已经超过","messageNext":"天未更新，文章中的内容有可能已失效，请慎重使用。"},
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: {"limitCount":50,"languages":{"author":"作者: QianChengGit","link":"链接: ","source":"来源: QianChengGitの小森林","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。"}},
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#49b1f5","bgDark":"#121212","position":"top-center"},
  source: {
    jQuery: 'https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js',
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
    },
    fancybox: {
      js: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js',
      css: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: true,
  isanchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = { 
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2023-02-12 20:50:00'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const fontSizeVal = saveToLocal.get('global-font-size')
    if (fontSizeVal !== undefined) {
      document.documentElement.style.setProperty('--global-font-size', fontSizeVal + 'px')
    }
    })(window)</script><link rel="stylesheet" href="//at.alicdn.com/t/font_2789073_30gzwllgsi5.css"><link rel="stylesheet" href="/css/custom.css"  media="defer" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-animate@1.0.0/animate.min.css" media="defer" onload="this.media='all'"><link rel="stylesheet" href="//at.alicdn.com/t/font_2789073_0g4y7n3ar1uw.css"><!-- hexo injector head_end start --><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-butterfly-footer-beautify@1.0.0/lib/runtime.css" media="defer" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-butterfly-swiper/lib/swiper.min.css" media="defer" onload="this.media='all'"><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-swiper/lib/swiper.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-swiper/lib/swiperstyle.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css" media="print" onload="this.media='screen'"><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-tag-plugins-plus@latest/lib/assets/font-awesome-animation.min.css" media="defer" onload="this.media='all'"><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-tag-plugins-plus@latest/lib/tag_plugins.css" media="defer" onload="this.media='all'"><script src="https://npm.elemecdn.com/hexo-butterfly-tag-plugins-plus@latest/lib/assets/carousel-touch.js"></script><!-- hexo injector head_end end --><meta name="generator" content="Hexo 5.4.0"></head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="spinner-box"><div class="configure-border-1"><div class="configure-core"></div></div><div class="configure-border-2"><div class="configure-core"></div></div><div class="loading-word">加载中...</div></div></div><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="author-avatar"><img class="avatar-img" data-lazy-src="/img/avatar.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data"><div class="data-item is-center"><div class="data-item-link"><a href="/archives/"><div class="headline">文章</div><div class="length-num">41</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/tags/"><div class="headline">标签</div><div class="length-num">36</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/categories/"><div class="headline">分类</div><div class="length-num">30</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw iconfont icon-fangzilengjiao"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw iconfont icon-wenjianjia"></i><span> 归档</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/archives/"><i class="fa-fw iconfont icon-wenzhang"></i><span> 文章</span></a></li><li><a class="site-page" href="/tags/"><i class="fa-fw iconfont icon-tubiaozhizuomoban-"></i><span> 标签</span></a></li><li><a class="site-page" href="/categories/"><i class="fa-fw iconfont icon-wenjianjia"></i><span> 分类</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw iconfont icon-gongjuxiang1"></i><span> 工具</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/navigation/"><i class="fa-fw iconfont icon-baoxiang"></i><span> 百宝箱</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/comments/"><i class="fa-fw iconfont icon-liuyanmoban"></i><span> 留言板</span></a></div><div class="menus_item"><a class="site-page" href="/fcircle/"><i class="fa-fw iconfont icon-communication"></i><span> 朋友圈</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw iconfont icon-fangke"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw iconfont icon-gerenziliao"></i><span> 关于我</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background: transparent"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">QianChengGitの小森林</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw iconfont icon-fangzilengjiao"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw iconfont icon-wenjianjia"></i><span> 归档</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/archives/"><i class="fa-fw iconfont icon-wenzhang"></i><span> 文章</span></a></li><li><a class="site-page" href="/tags/"><i class="fa-fw iconfont icon-tubiaozhizuomoban-"></i><span> 标签</span></a></li><li><a class="site-page" href="/categories/"><i class="fa-fw iconfont icon-wenjianjia"></i><span> 分类</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw iconfont icon-gongjuxiang1"></i><span> 工具</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/navigation/"><i class="fa-fw iconfont icon-baoxiang"></i><span> 百宝箱</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/comments/"><i class="fa-fw iconfont icon-liuyanmoban"></i><span> 留言板</span></a></div><div class="menus_item"><a class="site-page" href="/fcircle/"><i class="fa-fw iconfont icon-communication"></i><span> 朋友圈</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw iconfont icon-fangke"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw iconfont icon-gerenziliao"></i><span> 关于我</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">Docker基础入门</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2023-02-12T20:50:00.000Z" title="发表于 2023-02-12 20:50:00">2023-02-12</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2023-02-12T20:50:00.000Z" title="更新于 2023-02-12 20:50:00">2023-02-12</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/Docker/">Docker</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">10.3k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>51分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="Docker基础入门"><a href="#Docker基础入门" class="headerlink" title="Docker基础入门"></a>Docker基础入门</h1><h2 id="一、CentOS7安装Docker"><a href="#一、CentOS7安装Docker" class="headerlink" title="一、CentOS7安装Docker"></a>一、CentOS7安装Docker</h2><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">查看服务器内核版本</span></span><br><span class="line">uname -r</span><br><span class="line"><span class="meta">#</span><span class="bash">查看系统信息</span></span><br><span class="line">cat /etc/os-release</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">1.yum包更新到最新</span></span><br><span class="line">sudo yum update</span><br><span class="line"><span class="meta">#</span><span class="bash">2.安装需要的软件包，yum-util提供yum-config-manager功能，另外两个是devicemapper驱动依赖的</span></span><br><span class="line">sudo yum install -y yum-util device-mapper-persistent-data lvm2</span><br><span class="line"><span class="meta">#</span><span class="bash">3.设置yum源</span></span><br><span class="line"><span class="meta">#</span><span class="bash">使用官方源地址（比较慢）</span></span><br><span class="line">sudo yum-config-manager \</span><br><span class="line">    --add-repo \</span><br><span class="line">    https://download.docker.com/linux/centos/docker-ce.repo</span><br><span class="line"><span class="meta">#</span><span class="bash">建议使用阿里云地址（比较快）</span></span><br><span class="line">sudo yum-config-manager \</span><br><span class="line">    --add-repo \</span><br><span class="line">    http://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo</span><br><span class="line"><span class="meta">#</span><span class="bash">结果</span></span><br><span class="line">Loaded plugins: fastestmirror, langpacks</span><br><span class="line">adding repo from: http://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo</span><br><span class="line">grabbing file http://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo to /etc/yum.repos.d/docker-ce.repo</span><br><span class="line">repo saved to /etc/yum.repos.d/docker-ce.repo</span><br><span class="line"><span class="meta">#</span><span class="bash">更新yum软件包索引</span></span><br><span class="line">yum makecache fast</span><br><span class="line"><span class="meta">#</span><span class="bash">结果</span></span><br><span class="line">Loaded plugins: fastestmirror, langpacks</span><br><span class="line">Determining fastest mirrors</span><br><span class="line">docker-ce-stable                                                                                                                                            | 3.5 kB  00:00:00</span><br><span class="line">epel                                                                                                                                                        | 4.7 kB  00:00:00</span><br><span class="line">extras                                                                                                                                                      | 2.9 kB  00:00:00</span><br><span class="line">os                                                                                                                                                          | 3.6 kB  00:00:00</span><br><span class="line">updates                                                                                                                                                     | 2.9 kB  00:00:00</span><br><span class="line">(1/2): docker-ce-stable/7/x86_64/updateinfo                                                                                                                 |   55 B  00:00:00</span><br><span class="line">(2/2): docker-ce-stable/7/x86_64/primary_db                                                                                                                 |  97 kB  00:00:00</span><br><span class="line">Metadata Cache Created</span><br><span class="line"><span class="meta">#</span><span class="bash">4.安装docker，出现输入的界面都按Y，出现Complete!便成功了。</span></span><br><span class="line">sudo yum install docker-ce docker-ce-cli containerd.io docker-buildx-plugin docker-compose-plugin</span><br><span class="line"><span class="meta">#</span><span class="bash">结果</span></span><br><span class="line">Loaded plugins: fastestmirror, langpacks</span><br><span class="line">Loading mirror speeds from cached hostfile</span><br><span class="line">Total download size: 107 M</span><br><span class="line">Installed size: 376 M</span><br><span class="line"><span class="meta">#</span><span class="bash">这里选y</span></span><br><span class="line">Is this ok [y/d/N]: y</span><br><span class="line">Downloading packages:</span><br><span class="line">(1/18): container-selinux-2.119.2-1.911c772.el7_8.noarch.rpm                                                                                                |  40 kB  00:00:00</span><br><span class="line">(2/18): audit-libs-python-2.8.5-4.el7.x86_64.rpm        MB  00:00:59</span><br><span class="line">Retrieving key from https://mirrors.aliyun.com/docker-ce/linux/centos/gpg</span><br><span class="line">Importing GPG key 0x621E9F35:</span><br><span class="line">Userid     : &quot;Docker Release (CE rpm) &lt;docker@docker.com&gt;&quot;</span><br><span class="line">Fingerprint: 060a 61c5 1b55 8a7f 742b 77aa c52f eb6b 621e 9f35</span><br><span class="line">From       : https://mirrors.aliyun.com/docker-ce/linux/centos/gpg</span><br><span class="line"><span class="meta">#</span><span class="bash">这里选y</span></span><br><span class="line">Is this ok [y/N]: y</span><br><span class="line">Running transaction check</span><br><span class="line">Running transaction test</span><br><span class="line">Transaction test succeeded</span><br><span class="line">Running transaction</span><br><span class="line">Warning: RPMDB altered outside of yum.</span><br><span class="line">** Found 2 pre-existing rpmdb problem(s), &#x27;yum check&#x27; output follows:</span><br><span class="line">······</span><br><span class="line">Installed:</span><br><span class="line">containerd.io.x86_64 0:1.6.16-3.1.el7            docker-buildx-plugin.x86_64 0:0.10.2-1.el7      docker-ce.x86_64 3:23.0.1-1.el7      docker-ce-cli.x86_64 1:23.0.1-1.el7</span><br><span class="line">docker-compose-plugin.x86_64 0:2.16.0-1.el7</span><br><span class="line"></span><br><span class="line">Dependency Installed:</span><br><span class="line">audit-libs-python.x86_64 0:2.8.5-4.el7                      checkpolicy.x86_64 0:2.5-8.el7                       container-selinux.noarch 2:2.119.2-1.911c772.el7_8</span><br><span class="line">docker-ce-rootless-extras.x86_64 0:23.0.1-1.el7             docker-scan-plugin.x86_64 0:0.23.0-3.el7             fuse-overlayfs.x86_64 0:0.7.2-6.el7_8</span><br><span class="line">fuse3-libs.x86_64 0:3.6.1-4.el7                             libcgroup.x86_64 0:0.41-21.el7                       libsemanage-python.x86_64 0:2.5-14.el7</span><br><span class="line">policycoreutils-python.x86_64 0:2.5-34.el7                  python-IPy.noarch 0:0.75-6.el7                       setools-libs.x86_64 0:3.3.8-4.el7</span><br><span class="line">slirp4netns.x86_64 0:0.4.3-4.el7_8</span><br><span class="line"></span><br><span class="line">Complete!</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">5.查看docker版本，验证是否安装成功</span></span><br><span class="line">sudo docker version</span><br><span class="line"><span class="meta">#</span><span class="bash">结果</span></span><br><span class="line">Client: Docker Engine - Community</span><br><span class="line">Version:           23.0.1</span><br><span class="line">API version:       1.42</span><br><span class="line">Go version:        go1.19.5</span><br><span class="line">Git commit:        a5ee5b1</span><br><span class="line">Built:             Thu Feb  9 19:51:00 2023</span><br><span class="line">OS/Arch:           linux/amd64</span><br><span class="line">Context:           default</span><br><span class="line"></span><br><span class="line">Server: Docker Engine - Community</span><br><span class="line">Engine:</span><br><span class="line">Version:          23.0.1</span><br><span class="line">API version:      1.42 (minimum version 1.12)</span><br><span class="line">Go version:       go1.19.5</span><br><span class="line">Git commit:       bc3805a</span><br><span class="line">Built:            Thu Feb  9 19:48:42 2023</span><br><span class="line">OS/Arch:          linux/amd64</span><br><span class="line">Experimental:     false</span><br><span class="line">containerd:</span><br><span class="line">Version:          1.6.16</span><br><span class="line">GitCommit:        31aa4358a36870b21a992d3ad2bef29e1d693bec</span><br><span class="line">runc:</span><br><span class="line">Version:          1.1.4</span><br><span class="line">GitCommit:        v1.1.4-0-g5fd4c4d</span><br><span class="line">docker-init:</span><br><span class="line">Version:          0.19.0</span><br><span class="line">GitCommit:        de40ad0</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">6.启动docker</span></span><br><span class="line">sudo systemctl start docker</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">7.通过运行hello-world映像来验证 Docker 引擎安装是否成功。</span></span><br><span class="line">sudo docker run hello-world</span><br><span class="line"><span class="meta">#</span><span class="bash">结果</span></span><br><span class="line">Unable to find image &#x27;hello-world:latest&#x27; locally</span><br><span class="line">latest: Pulling from library/hello-world</span><br><span class="line">2db29710123e: Pull complete</span><br><span class="line">Digest: sha256:aa0cc8055b82dc2509bed2e19b275c8f463506616377219d9642221ab53cf9fe</span><br><span class="line">Status: Downloaded newer image for hello-world:latest</span><br><span class="line"></span><br><span class="line">Hello from Docker!</span><br><span class="line">This message shows that your installation appears to be working correctly.</span><br><span class="line"></span><br><span class="line">To generate this message, Docker took the following steps:</span><br><span class="line">1. The Docker client contacted the Docker daemon.</span><br><span class="line">2. The Docker daemon pulled the &quot;hello-world&quot; image from the Docker Hub.</span><br><span class="line">(amd64)</span><br><span class="line">3. The Docker daemon created a new container from that image which runs the</span><br><span class="line">executable that produces the output you are currently reading.</span><br><span class="line">4. The Docker daemon streamed that output to the Docker client, which sent it</span><br><span class="line">to your terminal.</span><br><span class="line"></span><br><span class="line">To try something more ambitious, you can run an Ubuntu container with:</span><br><span class="line"><span class="meta">$</span><span class="bash"> docker run -it ubuntu bash</span></span><br><span class="line"></span><br><span class="line">Share images, automate workflows, and more with a free Docker ID:</span><br><span class="line">https://hub.docker.com/</span><br><span class="line"></span><br><span class="line">For more examples and ideas, visit:</span><br><span class="line">https://docs.docker.com/get-started/</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">8.停止docker</span></span><br><span class="line"><span class="meta">#</span><span class="bash">虽然停止了docker服务，但是docker服务在关闭状态下有被访问自动唤醒的机制，即这时再执行任意docker命令会直接启动docker服务</span></span><br><span class="line">sudo systemctl stop docker</span><br><span class="line"><span class="meta">#</span><span class="bash">如果真的不希望docker被访问自动唤醒，需要把守护进程服务也关掉</span></span><br><span class="line">sudo systemctl stop docker.socket</span><br><span class="line"><span class="meta">#</span><span class="bash">查看docker是否真被关掉，查看docker状态</span></span><br><span class="line">sudo systemctl status docker</span><br></pre></td></tr></table></figure>
<p>卸载docker：</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">1.卸载依赖</span></span><br><span class="line">sudo yum remove docker-ce docker-ce-cli containerd.io docker-buildx-plugin docker-compose-plugin docker-ce-rootless-extras</span><br><span class="line"><span class="meta">#</span><span class="bash">2.删除资源目录（/var/lib/docker   docker的默认工作路径）</span></span><br><span class="line">sudo rm -rf /var/lib/docker</span><br><span class="line">sudo rm -rf /var/lib/containerd</span><br></pre></td></tr></table></figure>
<h2 id="二、Docker的基本命令"><a href="#二、Docker的基本命令" class="headerlink" title="二、Docker的基本命令"></a>二、Docker的基本命令</h2><h3 id="帮助命令"><a href="#帮助命令" class="headerlink" title="帮助命令"></a>帮助命令</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">docker version #显示docker的版本信息</span><br><span class="line">docker info #显示docker的系统信息，包括镜像和容器的数量</span><br><span class="line">docker 命令 --help #万能命令</span><br></pre></td></tr></table></figure>
<p>帮助文档地址：<a target="_blank" rel="noopener" href="https://docs.docker.com/engine/reference/commandline/docker/">docker | Docker Documentation</a></p>
<h3 id="镜像命令"><a href="#镜像命令" class="headerlink" title="镜像命令"></a>镜像命令</h3><p><strong>docker images</strong> 查看所有本地的主机上的镜像</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">[lighthouse@VM-16-5-centos /]$ sudo docker images</span><br><span class="line">REPOSITORY    TAG       IMAGE ID       CREATED         SIZE</span><br><span class="line">hello-world   latest    feb5d9fea6a5   16 months ago   13.3kB</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 解释</span></span><br><span class="line">REPOSITORY  # 镜像的仓库源</span><br><span class="line">TAG         # 镜像的标签</span><br><span class="line">IMAGE ID    # 镜像的id</span><br><span class="line">CREATED     # 镜像的创建时间</span><br><span class="line">SIZE        # 镜像的大小</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 可选项</span></span><br><span class="line">-a, --all    # 列出所有镜像</span><br><span class="line">-q, --quiet  # 只显示镜像的id</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p><strong>docker search</strong> 搜索镜像</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">[lighthouse@VM-16-5-centos /]$ sudo docker search mysql</span><br><span class="line">NAME                            DESCRIPTION                                     STARS     OFFICIAL   AUTOMATED</span><br><span class="line">mysql                           MySQL is a widely used, open-source relation…   13780     [OK]       </span><br><span class="line">mariadb                         MariaDB Server is a high performing open sou…   5262      [OK]       </span><br><span class="line">percona                         Percona Server is a fork of the MySQL relati…   599       [OK]       </span><br><span class="line">phpmyadmin                      phpMyAdmin - A web interface for MySQL and M…   734       [OK]       </span><br><span class="line">circleci/mysql                  MySQL is a widely used, open-source relation…   28                   </span><br><span class="line">bitnami/mysql                   Bitnami MySQL Docker Image                      80                   [OK]</span><br><span class="line">bitnami/mysqld-exporter                                                         4                    </span><br><span class="line">ubuntu/mysql                    MySQL open source fast, stable, multi-thread…   41                   </span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 可选项，通过收藏数来过滤</span></span><br><span class="line">--filter=STARS=3000  #搜索出来的镜像就是收藏数大于3000的。</span><br></pre></td></tr></table></figure>
<p><strong>docker pull</strong> 下载镜像</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">下载镜像 docker pull 镜像名:tag</span></span><br><span class="line">[lighthouse@VM-16-5-centos /]$ sudo docker pull mysql:5.7</span><br><span class="line">5.7: Pulling from library/mysql #如果哦不写tag，默认就是最新版本</span><br><span class="line">e048d0a38742: Pull complete #分层下载docker image的核心，联合文件系统</span><br><span class="line">c7847c8a41cb: Pull complete </span><br><span class="line">351a550f260d: Pull complete </span><br><span class="line">8ce196d9d34f: Pull complete </span><br><span class="line">17febb6f2030: Pull complete </span><br><span class="line">d4e426841fb4: Pull complete </span><br><span class="line">fda41038b9f8: Pull complete </span><br><span class="line">f47aac56b41b: Pull complete </span><br><span class="line">a4a90c369737: Pull complete </span><br><span class="line">97091252395b: Pull complete </span><br><span class="line">84fac29d61e9: Pull complete </span><br><span class="line">Digest: sha256:8cf035b14977b26f4a47d98e85949a7dd35e641f88fc24aa4b466b36beecf9d6  #签名</span><br><span class="line">Status: Downloaded newer image for mysql:5.7</span><br><span class="line">docker.io/library/mysql:5.7 #真实地址</span><br></pre></td></tr></table></figure>
<p><strong>docker rmi -f [镜像ID]</strong> 删除镜像</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">删除镜像</span></span><br><span class="line">[lighthouse@VM-16-5-centos /]$ sudo docker rmi -f 57da161f45ac #删除指定的镜像</span><br><span class="line">Untagged: mysql:latest</span><br><span class="line">Untagged: mysql@sha256:8653a170e0b0df19ea95055267def2615fc53c62df529e3750817c1a886485f0</span><br><span class="line">Deleted: sha256:57da161f45ac3835bc872dcb50f0cde87f65661ba8f50a5a0835dee7e262703f</span><br><span class="line">Deleted: sha256:9e4b6222a6cefc0be6e8ade3cd1692188b6eecf71fcc2568a693c0e630614a0a</span><br><span class="line">Deleted: sha256:b1cc52ec5ce1f3261dbe86f7b09bb70061e71ece8b9a2864ed847187ddc7605a</span><br><span class="line">Deleted: sha256:06bb8fe22fec310fc5dabc4298e23b46b579d3a7d91413e18229195fe5f54436</span><br><span class="line">Deleted: sha256:1d45093bae7b3d23220a568d07cbee31bdc66e78b4a08d509684faa2500a4adc</span><br><span class="line">Deleted: sha256:a1631c5cec986cf56dfddd8f902a7c79052a0157d4ba325bb28f62c909d0e8ae</span><br><span class="line">Deleted: sha256:5020329708536d258b967ba499c93ce57ca8612b4b78c49d25c2a4a6ad5c8407</span><br><span class="line">Deleted: sha256:02ced332f0c6778bf91754fde67302bbc07bc5933b48a92c77b4576e984e55e8</span><br><span class="line">Deleted: sha256:b289f85ed3850442cb04b1f1f9b7a7409d88a43d277000cdb4f0e6e775a42a65</span><br><span class="line">Deleted: sha256:097c8299fba37fe21a9561d58e1e423d89873064b716aa74c233590db9c6db86</span><br><span class="line">Deleted: sha256:ea6feaa089dca094ae502b77cc9ffc86d2e42cd3fbe1a91d38ecf2064de7ac05</span><br><span class="line">Deleted: sha256:9cd9df9ffc972e9abc946d855162ef0c40dff9a89f10c962b7920154a3d943d8</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">删除多个镜像</span></span><br><span class="line">sudo docker rmi -f 镜像id 镜像id 镜像id</span><br><span class="line"><span class="meta">#</span><span class="bash">删除所有镜像</span></span><br><span class="line">sudo docker rmi -f $(docker images -aq)</span><br></pre></td></tr></table></figure>
<h3 id="容器命令"><a href="#容器命令" class="headerlink" title="容器命令"></a>容器命令</h3><p><strong>新建容器并启动</strong>（前提是已经下好了镜像）</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">新建容器并启动</span></span><br><span class="line">docker run [可选参数] image:[tag]</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">参数说明</span></span><br><span class="line">--name=&quot;Name&quot;  #容器名字，tomcat01、tomcat02用来区分容器</span><br><span class="line">-d             #后台方式运行</span><br><span class="line">-it            #使用交互方式运行，比如进入容器查看内容</span><br><span class="line">-p             #指定容器端口，比如 -p 8080 指定8080端口运行容器；也可以和主机端口映射，比如 -p 80:8080。</span><br><span class="line">	-p ip:主机端口:容器端口</span><br><span class="line">	-p 主机端口:容器端口（常用）</span><br><span class="line">	-p 容器端口</span><br><span class="line">-P             #大P 随机指定运行的端口。</span><br><span class="line">-e             #环境配置修改，列如：-e ES_JAVA_OPTS=&quot;-Xms64m -Xmx512m&quot; 修改内存最小占用64M和最大占用512M。</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">启动并进入容器</span></span><br><span class="line">sudo docker run -it mysql:5.7</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p><strong>列出所有运行中的容器</strong></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">列出所有正在运行的容器</span></span><br><span class="line">sudo docker ps</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">列出所有运行中容器+带出历史运行过得容器</span></span><br><span class="line">sudo docker ps -a</span><br><span class="line">sudo docker ps -aq #只显示所有容器的id</span><br><span class="line"><span class="meta">#</span><span class="bash">显示最近创建的容器, ? 为显示的个数</span></span><br><span class="line">sudo docker ps -n=?</span><br></pre></td></tr></table></figure>
<p><strong>退出容器</strong></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">停止并退出容器</span></span><br><span class="line">exit</span><br><span class="line"><span class="meta">#</span><span class="bash">容器不停止并退出</span></span><br><span class="line">快捷键 Ctrl + P + Q</span><br></pre></td></tr></table></figure>
<p><strong>删除容器</strong></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">sudo docker rm 容器id                    #删除指定的容器，不能删除正在运行的容器，如果要强制删除使用 rm -f。</span><br><span class="line">sudo docker rm -f $(docker ps -aq)      #删除所有容器</span><br><span class="line">sudo docker ps -a -q|xargs docker rm    #删除所有容器</span><br></pre></td></tr></table></figure>
<p><strong>启动和停止容器的操作</strong></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">sudo docker start 容器id      #启动一个已经停止了的容器</span><br><span class="line">sudo docker restart 容器id    #重启容器</span><br><span class="line">sudo docker stop 容器id       #停止当前正在运行的容器</span><br><span class="line">sudo docker kill 容器id       #强制停止容器，杀掉容器</span><br></pre></td></tr></table></figure>
<p><strong>查看容器使用主机资源</strong></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">sudo docker stats 容器id     #可以看到运行容器使用的CPU占用率和内存占用率</span><br></pre></td></tr></table></figure>
<h2 id="三、常用其他命令"><a href="#三、常用其他命令" class="headerlink" title="三、常用其他命令"></a>三、常用其他命令</h2><p><strong>后台启动容器</strong></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">命令： docker run -d 镜像名</span></span><br><span class="line">[lighthouse@VM-16-5-centos /]$ docker run -d centos</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">问题docker ps,发现 centos 停止了</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">常见的坑：docker容器使用后台运行，就必须要一个前台进程，docker发现没有应用，就会自动停止。</span></span><br><span class="line"><span class="meta">#</span><span class="bash">nginx容器启动后，发现自己没有提供服务就会立刻停止，就是没有程序了。</span></span><br></pre></td></tr></table></figure>
<p><strong>查看日志</strong></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">sudo docker logs -tf --tail 日志数量 容器id</span><br><span class="line"><span class="meta">#</span><span class="bash">选项</span></span><br><span class="line">-tf           #显示日志</span><br><span class="line">--tail number #number：想要显示的日志数量</span><br></pre></td></tr></table></figure>
<p><strong>查看容器中的进程信息</strong></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">查看容器的进程信息</span></span><br><span class="line">sudo docker top 容器id</span><br></pre></td></tr></table></figure>
<p><strong>查看镜像的元数据</strong></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">查看镜像的信息</span></span><br><span class="line">sudo docker image inspect 镜像名:tag</span><br><span class="line"><span class="meta">#</span><span class="bash">查看运行容器的信息</span></span><br><span class="line">sudo docker inspect 容器id</span><br></pre></td></tr></table></figure>
<p><strong>进入当前正在运行的容器</strong></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">我们通常容器都是使用后台方式运行的，需要进入容器，修改配置。</span></span><br><span class="line"><span class="meta">#</span><span class="bash">命令一</span></span><br><span class="line">sudo docker exec -it 容器id /bin/bash  #进入容器后开启一个新的终端，可以在里面操作（常用）</span><br><span class="line"><span class="meta">#</span><span class="bash">命令二</span></span><br><span class="line">sudo docker attach 容器id   #进入容器正在执行的终端，不会启动新的进程。</span><br></pre></td></tr></table></figure>
<p><strong>从容器内拷贝文件到主机上</strong></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">sudo docker cp 容器id:容器内路径 目的的主机路径</span><br></pre></td></tr></table></figure>
<h2 id="四、作业练习"><a href="#四、作业练习" class="headerlink" title="四、作业练习"></a>四、作业练习</h2><h3 id="1-docker安装nginx"><a href="#1-docker安装nginx" class="headerlink" title="1.docker安装nginx"></a>1.docker安装nginx</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">搜索镜像</span></span><br><span class="line">[lighthouse@VM-16-5-centos /]$ sudo docker search nginx</span><br><span class="line">NAME                                              DESCRIPTION                                     STARS     OFFICIAL   AUTOMATED</span><br><span class="line">nginx                                             Official build of Nginx.                        18074     [OK]       </span><br><span class="line">bitnami/nginx                                     Bitnami nginx Docker Image                      150                  [OK]</span><br><span class="line">bitnami/nginx-ingress-controller                  Bitnami Docker Image for NGINX Ingress Contr…   23                   [OK]</span><br><span class="line">ubuntu/nginx                                      Nginx, a high-performance reverse proxy &amp; we…   77                   </span><br><span class="line">kasmweb/nginx                                     An Nginx image based off nginx:alpine and in…   4                    </span><br><span class="line">rancher/nginx-ingress-controller                                                                  11                   </span><br><span class="line">rancher/nginx-ingress-controller-defaultbackend                                                   2                    </span><br><span class="line">bitnami/nginx-exporter                                                                            3                    </span><br><span class="line">rancher/nginx                                                                                     2                    </span><br><span class="line">ibmcom/nginx-ingress-controller                   Docker Image for IBM Cloud Private-CE (Commu…   4                    </span><br><span class="line">rapidfort/nginx-ib                                RapidFort optimized, hardened image for NGIN…   0                    </span><br><span class="line">vmware/nginx-photon                                                                               1                    </span><br><span class="line">rapidfort/nginx                                   RapidFort optimized, hardened image for NGINX   2                    </span><br><span class="line">ibmcom/nginx-ingress-controller-ppc64le           Docker Image for IBM Cloud Private-CE (Commu…   0                    </span><br><span class="line">bitnami/nginx-ldap-auth-daemon                                                                    3                    </span><br><span class="line">ibmcom/nginx-ppc64le                              Docker image for nginx-ppc64le                  0                    </span><br><span class="line">vmware/nginx                                                                                      2                    </span><br><span class="line">rancher/nginx-conf                                                                                0                    </span><br><span class="line">rapidfort/nginx-official                          RapidFort optimized, hardened image for NGIN…   1                    </span><br><span class="line">linuxserver/nginx                                 An Nginx container, brought to you by LinuxS…   184                  </span><br><span class="line">privatebin/nginx-fpm-alpine                       PrivateBin running on an Nginx, php-fpm &amp; Al…   72                   [OK]</span><br><span class="line">bitnami/nginx-intel                                                                               1                    </span><br><span class="line">rancher/nginx-ssl                                                                                 0                    </span><br><span class="line">circleci/nginx                                    This image is for internal use                  2                    </span><br><span class="line">continuumio/nginx-ingress-ws                                                                      0            </span><br><span class="line"><span class="meta">#</span><span class="bash">下载镜像</span></span><br><span class="line">[lighthouse@VM-16-5-centos /]$ sudo docker pull nginx</span><br><span class="line">Using default tag: latest</span><br><span class="line">latest: Pulling from library/nginx</span><br><span class="line">bb263680fed1: Already exists </span><br><span class="line">258f176fd226: Pull complete </span><br><span class="line">a0bc35e70773: Pull complete </span><br><span class="line">077b9569ff86: Pull complete </span><br><span class="line">3082a16f3b61: Pull complete </span><br><span class="line">7e9b29976cce: Pull complete </span><br><span class="line">Digest: sha256:6650513efd1d27c1f8a5351cbd33edf85cc7e0d9d0fcb4ffb23d8fa89b601ba8</span><br><span class="line">Status: Downloaded newer image for nginx:latest</span><br><span class="line">docker.io/library/nginx:latest</span><br><span class="line"><span class="meta">#</span><span class="bash">运行镜像</span></span><br><span class="line">[lighthouse@VM-16-5-centos /]$ sudo docker run -d --name nginx01 -p 3344:80 nginx</span><br><span class="line">62922997834fabe72a1051794ac449392d8649cb4de930a8f3afe54c9a086c38</span><br><span class="line"><span class="meta">#</span><span class="bash">查看镜像是否运行</span></span><br><span class="line">[lighthouse@VM-16-5-centos /]$ sudo docker ps</span><br><span class="line">CONTAINER ID   IMAGE     COMMAND                  CREATED          STATUS          PORTS                                   NAMES</span><br><span class="line">62922997834f   nginx     &quot;/docker-entrypoint.…&quot;   20 seconds ago   Up 19 seconds   0.0.0.0:3344-&gt;80/tcp, :::3344-&gt;80/tcp   nginx01</span><br><span class="line"><span class="meta">#</span><span class="bash">访问本机3344端口，测试镜像是否运行成功</span></span><br><span class="line">[lighthouse@VM-16-5-centos /]$ curl localhost:3344</span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;title&gt;Welcome to nginx!&lt;/title&gt;</span><br><span class="line">&lt;style&gt;</span><br><span class="line">html &#123; color-scheme: light dark; &#125;</span><br><span class="line">body &#123; width: 35em; margin: 0 auto;</span><br><span class="line">font-family: Tahoma, Verdana, Arial, sans-serif; &#125;</span><br><span class="line">&lt;/style&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;h1&gt;Welcome to nginx!&lt;/h1&gt;</span><br><span class="line">&lt;p&gt;If you see this page, the nginx web server is successfully installed and</span><br><span class="line">working. Further configuration is required.&lt;/p&gt;</span><br><span class="line"></span><br><span class="line">&lt;p&gt;For online documentation and support please refer to</span><br><span class="line">&lt;a href=&quot;http://nginx.org/&quot;&gt;nginx.org&lt;/a&gt;.&lt;br/&gt;</span><br><span class="line">Commercial support is available at</span><br><span class="line">&lt;a href=&quot;http://nginx.com/&quot;&gt;nginx.com&lt;/a&gt;.&lt;/p&gt;</span><br><span class="line"></span><br><span class="line">&lt;p&gt;&lt;em&gt;Thank you for using nginx.&lt;/em&gt;&lt;/p&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br><span class="line"><span class="meta">#</span><span class="bash">进入容器</span></span><br><span class="line">[lighthouse@VM-16-5-centos /]$ sudo docker exec -it 62922997834f /bin/bash</span><br><span class="line">root@62922997834f:/# </span><br><span class="line"><span class="meta">#</span><span class="bash">查看容器路径及内容</span></span><br><span class="line">root@62922997834f:/# whereis nginx</span><br><span class="line">nginx: /usr/sbin/nginx /usr/lib/nginx /etc/nginx /usr/share/nginx</span><br><span class="line">root@62922997834f:/# cd /etc/nginx</span><br><span class="line">root@62922997834f:/etc/nginx# ls</span><br><span class="line">conf.d  fastcgi_params  mime.types  modules  nginx.conf  scgi_params  uwsgi_params</span><br><span class="line"><span class="meta">#</span><span class="bash">退出容器</span></span><br><span class="line">root@62922997834f:/# exit</span><br><span class="line">exit</span><br><span class="line">[lighthouse@VM-16-5-centos /]$</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="2、docker安装tomcat"><a href="#2、docker安装tomcat" class="headerlink" title="2、docker安装tomcat"></a>2、docker安装tomcat</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">官方的使用</span></span><br><span class="line">docker run -it --rm tomcat:9.0</span><br><span class="line"><span class="meta">#</span><span class="bash">我们之前启动都是后台，停止了容器之后，容器还可以查到。docker run -it --rm tomcat:9.0 一般用来测试，用完即删。</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">我们使用后台启动</span></span><br><span class="line"><span class="meta">#</span><span class="bash">下载tomcat镜像</span></span><br><span class="line">[lighthouse@VM-16-5-centos /]$ sudo docker pull tomcat:9.0</span><br><span class="line">9.0: Pulling from library/tomcat</span><br><span class="line">10ac4908093d: Pull complete </span><br><span class="line">6df15e605e38: Pull complete </span><br><span class="line">2db012dd504c: Pull complete </span><br><span class="line">8fa912900627: Pull complete </span><br><span class="line">f8fe20946c04: Pull complete </span><br><span class="line">1f8839e6ed79: Pull complete </span><br><span class="line">0839ea5a8b1a: Pull complete </span><br><span class="line">Digest: sha256:88d10376048d05596c7dc0d4b18b29015b4116871698facdcb1fd20c41e33cb7</span><br><span class="line">Status: Downloaded newer image for tomcat:9.0</span><br><span class="line">docker.io/library/tomcat:9.0</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">启动容器</span></span><br><span class="line">[lighthouse@VM-16-5-centos /]$ sudo docker run -d -p 3355:8080 --name tomcat01 tomcat:9.0</span><br><span class="line">dcf25e61c13894a0d61870fcc1ad6a4cefcb531b00e9cd5fec5f7d54971d6871</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">查看容器是否启动</span></span><br><span class="line">[lighthouse@VM-16-5-centos /]$ sudo docker ps</span><br><span class="line">CONTAINER ID   IMAGE        COMMAND             CREATED          STATUS          PORTS                                       NAMES</span><br><span class="line">dcf25e61c138   tomcat:9.0   &quot;catalina.sh run&quot;   44 seconds ago   Up 43 seconds   0.0.0.0:3355-&gt;8080/tcp, :::3355-&gt;8080/tcp   tomcat01</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">进入容器</span></span><br><span class="line">[lighthouse@VM-16-5-centos /]$ sudo docker exec -it tomcat01 /bin/bash</span><br><span class="line">root@dcf25e61c138:/usr/local/tomcat# ls</span><br><span class="line">bin  BUILDING.txt  conf  CONTRIBUTING.md  lib  LICENSE  logs  native-jni-lib  NOTICE  README.md  RELEASE-NOTES  RUNNING.txt  temp  webapps  webapps.dist  work</span><br><span class="line">root@dcf25e61c138:/usr/local/tomcat# ls -al</span><br><span class="line">total 172</span><br><span class="line">drwxr-xr-x 1 root root  4096 Feb  1 02:41 .</span><br><span class="line">drwxr-xr-x 1 root root  4096 Feb  1 02:37 ..</span><br><span class="line">drwxr-xr-x 2 root root  4096 Feb  1 02:41 bin</span><br><span class="line">-rw-r--r-- 1 root root 19992 Jan  9 22:33 BUILDING.txt</span><br><span class="line">drwxr-xr-x 1 root root  4096 Feb 13 06:32 conf</span><br><span class="line">-rw-r--r-- 1 root root  6210 Jan  9 22:33 CONTRIBUTING.md</span><br><span class="line">drwxr-xr-x 2 root root  4096 Feb  1 02:41 lib</span><br><span class="line">-rw-r--r-- 1 root root 57092 Jan  9 22:33 LICENSE</span><br><span class="line">drwxrwxrwx 1 root root  4096 Feb 13 06:32 logs</span><br><span class="line">drwxr-xr-x 2 root root  4096 Feb  1 02:41 native-jni-lib</span><br><span class="line">-rw-r--r-- 1 root root  2333 Jan  9 22:33 NOTICE</span><br><span class="line">-rw-r--r-- 1 root root  3398 Jan  9 22:33 README.md</span><br><span class="line">-rw-r--r-- 1 root root  6901 Jan  9 22:33 RELEASE-NOTES</span><br><span class="line">-rw-r--r-- 1 root root 16505 Jan  9 22:33 RUNNING.txt</span><br><span class="line">drwxrwxrwx 2 root root  4096 Feb  1 02:41 temp</span><br><span class="line">drwxr-xr-x 2 root root  4096 Feb  1 02:41 webapps</span><br><span class="line">drwxr-xr-x 7 root root  4096 Jan  9 22:33 webapps.dist</span><br><span class="line">drwxrwxrwx 2 root root  4096 Jan  9 22:33 work</span><br><span class="line">root@dcf25e61c138:/usr/local/tomcat# cd webapps</span><br><span class="line"><span class="meta">#</span><span class="bash">进入webapps文件夹发现没有文件</span></span><br><span class="line">root@dcf25e61c138:/usr/local/tomcat/webapps# ls</span><br><span class="line">root@dcf25e61c138:/usr/local/tomcat/webapps# cd ..</span><br><span class="line"><span class="meta">#</span><span class="bash">进入webapps.dist文件夹发现tomcat页面文件在这</span></span><br><span class="line">root@dcf25e61c138:/usr/local/tomcat# cd webapps.dist/</span><br><span class="line">root@dcf25e61c138:/usr/local/tomcat/webapps.dist# ls</span><br><span class="line">docs  examples  host-manager  manager  ROOT</span><br><span class="line">root@dcf25e61c138:/usr/local/tomcat/webapps.dist# cd ..</span><br><span class="line"><span class="meta">#</span><span class="bash">将webapps.dist目录下的所有文件拷贝到webapps目录</span></span><br><span class="line">root@dcf25e61c138:/usr/local/tomcat# cp -r webapps.dist/* webapps</span><br><span class="line">root@dcf25e61c138:/usr/local/tomcat# cd webapps</span><br><span class="line">root@dcf25e61c138:/usr/local/tomcat/webapps# ls -al</span><br><span class="line">total 32</span><br><span class="line">drwxr-xr-x  1 root root 4096 Feb 13 06:46 .</span><br><span class="line">drwxr-xr-x  1 root root 4096 Feb  1 02:41 ..</span><br><span class="line">drwxr-xr-x 15 root root 4096 Feb 13 06:46 docs</span><br><span class="line">drwxr-xr-x  7 root root 4096 Feb 13 06:46 examples</span><br><span class="line">drwxr-xr-x  6 root root 4096 Feb 13 06:46 host-manager</span><br><span class="line">drwxr-xr-x  6 root root 4096 Feb 13 06:46 manager</span><br><span class="line">drwxr-xr-x  3 root root 4096 Feb 13 06:46 ROOT</span><br><span class="line">root@dcf25e61c138:/usr/local/tomcat/webapps# </span><br><span class="line"><span class="meta">#</span><span class="bash">此时访问3355端口就会出现tomcat初始欢迎页面</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">退出容器</span></span><br><span class="line">root@dcf25e61c138:/usr/local/tomcat# exit</span><br><span class="line">exit</span><br></pre></td></tr></table></figure>
<h3 id="3、docker安装portainer"><a href="#3、docker安装portainer" class="headerlink" title="3、docker安装portainer"></a>3、docker安装portainer</h3><p><strong>什么是portainer？</strong></p>
<p>Docker图形化界面管理工具！提供一个后台面板供我们操作！</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">安装并运行portainer容器</span></span><br><span class="line">sudo docker run -d -p 8088:9000 \</span><br><span class="line">--restart=always -v /var/run/docker.sock:/var/run/docker.sock --privileged=true portainer/portainer</span><br></pre></td></tr></table></figure>
<p>访问<a href="https://ip:8088，出现登录界面，设置密码并登录，选择连接本地docker，就可以管理docker了！">https://ip:8088，出现登录界面，设置密码并登录，选择连接本地docker，就可以管理docker了！</a></p>
<h2 id="五、Docker镜像讲解"><a href="#五、Docker镜像讲解" class="headerlink" title="五、Docker镜像讲解"></a>五、Docker镜像讲解</h2><h3 id="1、commit镜像"><a href="#1、commit镜像" class="headerlink" title="1、commit镜像"></a>1、commit镜像</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">docker commit 提交容器成为一个新的副本</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">命令和git原理类似</span></span><br><span class="line">docker commit -a=&quot;作者&quot; -m=&quot;提交的描述信息&quot; 容器id 目标镜像名:[tag]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">实践</span></span><br><span class="line"><span class="meta">#</span><span class="bash">下载一个tomcat官方镜像，并运行镜像，发现webapps里没有文件。</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">将镜像里的webapps.dist目录里的文件拷贝到webapps目录。</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">将修改后的容器提交到本地docker镜像库，使用 docker images 发现已经提交到本地docker镜像库。</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">作用</span></span><br><span class="line"><span class="meta">#</span><span class="bash">可以将当前容器的状态，内容保存，相当于版本控制器。</span></span><br></pre></td></tr></table></figure>
<h2 id="六、容器数据卷"><a href="#六、容器数据卷" class="headerlink" title="六、容器数据卷"></a>六、容器数据卷</h2><blockquote>
<p>方式一：直接使用命令来挂载   -v</p>
<p>-v    表示将主机目录挂载到容器目录</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">sudo docker run -it -v 主机目录:容器内目录</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">测试</span></span><br><span class="line">sudo docker run -it -v /home/ceshi:/home centos /bin/bash</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="实战：Docker安装MySQL"><a href="#实战：Docker安装MySQL" class="headerlink" title="实战：Docker安装MySQL"></a>实战：Docker安装MySQL</h3><p>思考：MySQL的数据持久化问题  mysql数据都存储在data目录，需要将data目录映射到主机。</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">获取镜像</span></span><br><span class="line">sudo docker pull mysql:5.7</span><br><span class="line"><span class="meta">#</span><span class="bash">运行镜像(安装启动mysql时，需要配置密码，这是需要注意的一点)</span></span><br><span class="line"><span class="meta">#</span><span class="bash">官方示列(-e 表示要配置容器环境，-e MYSQL_ROOT_PASSWORD=root 表示配置mysql的密码为root)</span></span><br><span class="line">docker run --name some-mysql -e MYSQL_ROOT_PASSWORD=my-secret-pw -d mysql:tag</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">测试</span></span><br><span class="line">-d 后台启动</span><br><span class="line">-p 端口映射</span><br><span class="line">-v 卷挂载</span><br><span class="line">-e 环境配置</span><br><span class="line">--name 容器名称</span><br><span class="line"></span><br><span class="line">sudo docker run -d -p 3310:3306 -v /home/mysql/conf:/etc/mysql/conf.d -v /home/mysql/data:/var/lib/mysql -e MYSQL_ROOT_PASSWORD=123456 --name mysql01 mysql:5.7</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">启动之后在本地用Navicat连接测试。</span></span><br></pre></td></tr></table></figure>
<h3 id="具名和匿名挂载"><a href="#具名和匿名挂载" class="headerlink" title="具名和匿名挂载"></a>具名和匿名挂载</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">匿名挂载</span></span><br><span class="line">-v 容器内路径</span><br><span class="line"><span class="meta">#</span><span class="bash">示列</span></span><br><span class="line">sudo docker run -d -P --name nginx01 -v /etc/nginx nginx</span><br><span class="line"><span class="meta">#</span><span class="bash">查看所有的卷（volume）的情况</span></span><br><span class="line">sudo docker volume ls</span><br><span class="line"><span class="meta">#</span><span class="bash">结果</span></span><br><span class="line">[lighthouse@VM-16-5-centos /]$ sudo docker volume ls</span><br><span class="line">DRIVER    VOLUME NAME</span><br><span class="line">local     e2811eb1e2b4fad36ecf478e91e8ffc6f1c87f389266e29d2c73111631eacf52</span><br><span class="line"><span class="meta">#</span><span class="bash">这里发现-v 后面只写了容器内路径，没有写主机路径,得到的卷名是一串哈希值。</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">具名挂载</span></span><br><span class="line">-v 主机目录:容器内目录</span><br><span class="line"><span class="meta">#</span><span class="bash">示列</span></span><br><span class="line">sudo docker run -d -P --name nginx02 -v juming_nginx:/etc/nginx nginx</span><br><span class="line"><span class="meta">#</span><span class="bash">查看所有的卷（volume）的情况</span></span><br><span class="line">sudo docker volume ls</span><br><span class="line"><span class="meta">#</span><span class="bash">这里发现 -v 卷名:容器内路径,得到的卷名是指定的juming_nginx。</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">查看卷的信息</span></span><br><span class="line">sudo docker volume inspect 卷名</span><br><span class="line"><span class="meta">#</span><span class="bash">结果</span></span><br><span class="line">[lighthouse@VM-16-5-centos /]$ sudo docker volume inspect e2811eb1e2b4fad36ecf478e91e8ffc6f1c87f389266e29d2c73111631eacf52</span><br><span class="line">[</span><br><span class="line">    &#123;</span><br><span class="line">        &quot;CreatedAt&quot;: &quot;2023-02-12T17:47:52+08:00&quot;,</span><br><span class="line">        &quot;Driver&quot;: &quot;local&quot;,</span><br><span class="line">        &quot;Labels&quot;: null,</span><br><span class="line">        &quot;Mountpoint&quot;: &quot;/var/lib/docker/volumes/e2811eb1e2b4fad36ecf478e91e8ffc6f1c87f389266e29d2c73111631eacf52/_data&quot;,</span><br><span class="line">        &quot;Name&quot;: &quot;e2811eb1e2b4fad36ecf478e91e8ffc6f1c87f389266e29d2c73111631eacf52&quot;,</span><br><span class="line">        &quot;Options&quot;: null,</span><br><span class="line">        &quot;Scope&quot;: &quot;local&quot;</span><br><span class="line">    &#125;</span><br><span class="line">]</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>所有的docker容器内的卷，没有指定目录的情况下，所有的卷数据都是存储在 <code>/var/lib/docker/volumes/xxx卷名/_data</code> 目录下。</p>
<p>我们通过具名挂载可以方便的找到我们的一个卷，大多数情况使用<code>具名挂载</code>。</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 如何确定是具名挂载还是匿名挂载，还是指定路径挂载。</span></span><br><span class="line">-v 容器内路径            #匿名挂载</span><br><span class="line">-v 卷名:容器内路径        #具名挂载</span><br><span class="line">-v /主机路径:容器内路径    #指定路径挂载</span><br></pre></td></tr></table></figure>
<p>拓展：</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">通过 -v 容器内路径:ro|rw 改变读写权限</span></span><br><span class="line">ro readonly   #只读</span><br><span class="line">rw readwrite  #可读可写</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">一旦设置了这个容器只读权限，容器对我们挂载出来的内容就有限定了！</span></span><br><span class="line">sudo docker run -d -P --name nginx02 -v juming_nginx:/etc/nginx:ro nginx</span><br><span class="line"></span><br><span class="line">sudo docker run -d -P --name nginx02 -v juming_nginx:/etc/nginx:rw nginx</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">ro 只要看到ro就说明这个路径内容只能通过宿主机操作，容器内部无法操作。</span></span><br></pre></td></tr></table></figure>
<h3 id="初识Dockerfile"><a href="#初识Dockerfile" class="headerlink" title="初识Dockerfile"></a>初识Dockerfile</h3><p>Dockerfile就是用来构建docker镜像的构建文件，即命令脚本！</p>
<h4 id="通过脚本生成镜像"><a href="#通过脚本生成镜像" class="headerlink" title="通过脚本生成镜像"></a>通过脚本生成镜像</h4><ol>
<li><p>编写Dockerfile脚本文件</p>
 <figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">创建一个dockerfile文件，名字可以随机，建议Dockerfile。</span></span><br><span class="line"><span class="meta">#</span><span class="bash">文件中的内容: 指令(大写) 参数</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">基于CentOS镜像</span></span><br><span class="line">FROM centos</span><br><span class="line"><span class="meta">#</span><span class="bash">挂载数据卷（只写了容器内路径，是匿名挂载，挂载在宿主机的 `/var/lib/docker/volumes/xxx卷名/_data` 目录下）</span></span><br><span class="line">VOLUME [&quot;volume01&quot;,&quot;volume02&quot;]</span><br><span class="line"><span class="meta">#</span><span class="bash">结束了可以打印提示信息</span></span><br><span class="line">CMD echo &quot;---------end------------&quot;</span><br><span class="line"><span class="meta">#</span><span class="bash">构建好后进入bash控制台</span></span><br><span class="line">CMD /bin/bash</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">这里的每个命令，就是镜像的一层！</span></span><br></pre></td></tr></table></figure>
</li>
</ol>
<ol>
<li><p>在dockerfile文件所在的路径运行脚本构建镜像</p>
 <figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">注意命令结尾有一个（ . ）。</span></span><br><span class="line">sudo docker build -f dockerfile文件的路径 -t 自定义镜像名:tag .</span><br></pre></td></tr></table></figure>
</li>
</ol>
<ol>
<li>通过<code>sudo docker images</code>查看镜像是否生成成功！</li>
</ol>
<p>这种通过镜像挂载卷的方式使用的十分多，因为我们会经常构建自己的镜像。如果构建镜像时没有挂载卷，要手动挂载就通过 -v 命令进行挂载。</p>
<h3 id="数据卷容器"><a href="#数据卷容器" class="headerlink" title="数据卷容器"></a>数据卷容器</h3><p>实现容器的数据卷共享，列如多个mysql同步配置文件。</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">命令</span></span><br><span class="line">子容器 --volumes-from 父容器</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">测试</span></span><br><span class="line">sudo docker run -d -P --name centos01 -v ceshi:/volume01 centos</span><br><span class="line">sudo docker run -d -P --name centos02 --volumes-from centos01 centos</span><br></pre></td></tr></table></figure>
<p>结论：使用数据卷容器可以实现容器之间配置信息的传递与共享！数据卷容器的生命周期可以一直持续到没有容器使用为止！但是一旦你持久化本地，这个时候，本地的数据是不会被删除的！</p>
<h2 id="七、Dockerfile"><a href="#七、Dockerfile" class="headerlink" title="七、Dockerfile"></a>七、Dockerfile</h2><p>dockerfile是用来构建docker镜像的文件！命令参数脚本！</p>
<p>构建步骤：</p>
<ol>
<li>编写一个 dockerfile 文件</li>
<li>docker build 构建成一个镜像</li>
<li>docker run 运行镜像</li>
<li>docker push 发布镜像（DockerHub、阿里云仓库）</li>
</ol>
<h3 id="Dockerfile的指令"><a href="#Dockerfile的指令" class="headerlink" title="Dockerfile的指令"></a>Dockerfile的指令</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">FROM         #基础镜像，一切从这里构建</span><br><span class="line">MAINTAINER   #镜像是谁写的，姓名+邮箱</span><br><span class="line">RUN          #镜像构建的时候需要运行的命令</span><br><span class="line">ADD          #添加内容，比如制作tomcat镜像，需要添加tomcat压缩包</span><br><span class="line">WORKDIR      #镜像的工作目录。</span><br><span class="line">VOLUME       #设置卷，挂载主机目录</span><br><span class="line">EXPOSE       #指定暴露对外端口</span><br><span class="line">CMD          #指定这个容器启动的时候要运行的命令，与ENTRYPOINT区别（只有最后一个会生效，可被替代）</span><br><span class="line">ENTRYPOINT   #指定这个容器启动的时候要运行的命令</span><br><span class="line">ONBUILD      #当构建一个被继承 Dockerfile，这个指令被触发。ONBUILD是一个特殊的指令它后面跟的是其它指令，比如 RUN, COPY 等，而这些指令，在当前镜像构建时并不会被执行。只有当以当前镜像为基础镜像，去构建下一级镜像的时候才会被执行。</span><br><span class="line">COPY         #类似ADD命令，将我们的文件拷贝到镜像中，但不会自动解压。</span><br><span class="line">LABEL        #设置镜像的信息</span><br><span class="line">ENV          #构建的时候设置环境变量</span><br></pre></td></tr></table></figure>
<blockquote>
<p>CMD 和 ENTRYPOINT 的区别：</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">CMD          #指定这个容器启动的时候要运行的命令，只有最后一个会生效，可被替代。</span><br><span class="line">ENTRYPOINT   #指定这个容器启动的时候要运行的命令，可以追加命令。</span><br></pre></td></tr></table></figure>
</blockquote>
<h3 id="实战测试"><a href="#实战测试" class="headerlink" title="实战测试"></a>实战测试</h3><p>DockerHub中99%镜像都是从这个基础镜像过来的 FROM scratch，然后配置需要的软件和配置来进行构建。</p>
<p>创建一个自己的centos镜像：</p>
<ol>
<li><p>编写dockerfile文件：</p>
 <figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">FROM centos:7       #基于centos7镜像</span><br><span class="line">MAINTAINER qiancheng&lt;zehong.zhang@qq.com&gt;   #作者+邮箱</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">设置环境和工作路径</span></span><br><span class="line">ENV MYPATH /usr/local</span><br><span class="line">WORKDIR $MYPATH</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">为centos7基础镜像添加vim和net-tools</span></span><br><span class="line">RUN yum -y install vim</span><br><span class="line">RUN yum -y install net-tools</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">暴露80端口</span></span><br><span class="line">EXPOSE 80</span><br><span class="line"></span><br><span class="line">CMD [&quot;/bin/bash&quot;]   #进入bash</span><br></pre></td></tr></table></figure>
</li>
<li><p>通过dockerfile文件构建镜像：</p>
 <figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">通过dockerfile文件构建镜像</span></span><br><span class="line">sudo docker build -f dockerfile文件路径 -t 镜像名:[tag] .</span><br><span class="line"><span class="meta">#</span><span class="bash">查看生成的镜像</span></span><br><span class="line">sudo docker images</span><br></pre></td></tr></table></figure>
</li>
<li><p>查看镜像的构建步骤：</p>
 <figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">sudo docker history 镜像id</span><br></pre></td></tr></table></figure>
</li>
</ol>
<p>我们以后开发步骤：需要掌握Dockerfile的编写，我们之后的一切都是使用docker镜像发布运行！</p>
<h3 id="发布自己的镜像"><a href="#发布自己的镜像" class="headerlink" title="发布自己的镜像"></a>发布自己的镜像</h3><blockquote>
<p>DockerHub</p>
</blockquote>
<p>1、地址：<a target="_blank" rel="noopener" href="https://hub.docker.com/，注册自己的账号！">https://hub.docker.com/，注册自己的账号！</a></p>
<p>2、确定这个账号可以登录</p>
<p>3、在我们的服务器上提交自己的镜像</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">登录DockerHub账号</span></span><br><span class="line">[lighthouse@VM-16-5-centos local]$ sudo docker login --help</span><br><span class="line"></span><br><span class="line">Usage:  docker login [OPTIONS] [SERVER]</span><br><span class="line"></span><br><span class="line">Log in to a registry.</span><br><span class="line">If no server is specified, the default is defined by the daemon.</span><br><span class="line"></span><br><span class="line">Options:</span><br><span class="line">  -p, --password string   Password</span><br><span class="line">      --password-stdin    Take the password from stdin</span><br><span class="line">  -u, --username string   Username</span><br><span class="line">  </span><br><span class="line"><span class="meta">  #</span><span class="bash">登录账号</span></span><br><span class="line">  sudo docker login -u #之后提示输入密码</span><br></pre></td></tr></table></figure>
<p>4、登录成功后就可以提交镜像了</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">sudo docker tag 镜像id DockerHub的用户名/镜像名:tag</span><br><span class="line">sudo docker push DockerHub的用户名/镜像名:tag</span><br></pre></td></tr></table></figure>
<p>5、退出登录</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">sudo docker logout</span><br></pre></td></tr></table></figure>
<h2 id="八、Docker网络"><a href="#八、Docker网络" class="headerlink" title="八、Docker网络"></a>八、Docker网络</h2><h3 id="理解Docker0"><a href="#理解Docker0" class="headerlink" title="理解Docker0"></a>理解Docker0</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">Linux里查看本机ip地址</span></span><br><span class="line">ip addr</span><br><span class="line">ifconfig</span><br><span class="line"></span><br><span class="line">[root@VM-16-5-centos /]# ip addr   （或者ifconfig）</span><br><span class="line">1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1000</span><br><span class="line">    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00</span><br><span class="line">    inet 127.0.0.1/8 scope host lo</span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line">    inet6 ::1/128 scope host </span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line">2: eth0: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc mq state UP group default qlen 1000</span><br><span class="line">    link/ether 52:54:00:3f:4f:1c brd ff:ff:ff:ff:ff:ff</span><br><span class="line">    inet 10.0.16.5/22 brd 10.0.19.255 scope global eth0</span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line">    inet6 fe80::5054:ff:fe3f:4f1c/64 scope link </span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line">3: docker0: &lt;NO-CARRIER,BROADCAST,MULTICAST,UP&gt; mtu 1500 qdisc noqueue state DOWN group default </span><br><span class="line">    link/ether 02:42:d2:14:5c:09 brd ff:ff:ff:ff:ff:ff</span><br><span class="line">    inet 172.17.0.1/16 brd 172.17.255.255 scope global docker0</span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line">    inet6 fe80::42:d2ff:fe14:5c09/64 scope link </span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line">       </span><br><span class="line"><span class="meta">#</span><span class="bash">测试是否能ping通docker0</span></span><br><span class="line">[root@VM-16-5-centos /]# ping 172.17.0.1</span><br><span class="line">PING 172.17.0.1 (172.17.0.1) 56(84) bytes of data.</span><br><span class="line">64 bytes from 172.17.0.1: icmp_seq=1 ttl=64 time=0.039 ms</span><br><span class="line">64 bytes from 172.17.0.1: icmp_seq=2 ttl=64 time=0.041 ms</span><br><span class="line">64 bytes from 172.17.0.1: icmp_seq=3 ttl=64 time=0.042 ms</span><br><span class="line">64 bytes from 172.17.0.1: icmp_seq=4 ttl=64 time=0.036 ms</span><br><span class="line">^C</span><br><span class="line">--- 172.17.0.1 ping statistics ---</span><br><span class="line">4 packets transmitted, 4 received, 0% packet loss, time 3000ms</span><br><span class="line">rtt min/avg/max/mdev = 0.036/0.039/0.042/0.006 ms</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">查看tomcat容器相关信息</span></span><br><span class="line">[root@VM-16-5-centos /]# docker inspect dcf25e61c138</span><br><span class="line">[</span><br><span class="line">    &#123;</span><br><span class="line">        &quot;Id&quot;: &quot;dcf25e61c13894a0d61870fcc1ad6a4cefcb531b00e9cd5fec5f7d54971d6871&quot;,</span><br><span class="line">        &quot;Created&quot;: &quot;2023-02-13T06:32:31.773322109Z&quot;,</span><br><span class="line">        &quot;Path&quot;: &quot;catalina.sh&quot;,</span><br><span class="line">        &quot;Args&quot;: [</span><br><span class="line">            &quot;run&quot;</span><br><span class="line">        ],</span><br><span class="line">        &quot;State&quot;: &#123;</span><br><span class="line">            &quot;Status&quot;: &quot;running&quot;,</span><br><span class="line">            &quot;Running&quot;: true,</span><br><span class="line">            &quot;Paused&quot;: false,</span><br><span class="line">            &quot;Restarting&quot;: false,</span><br><span class="line">            &quot;OOMKilled&quot;: false,</span><br><span class="line">            &quot;Dead&quot;: false,</span><br><span class="line">            &quot;Pid&quot;: 19517,</span><br><span class="line">            &quot;ExitCode&quot;: 0,</span><br><span class="line">            &quot;Error&quot;: &quot;&quot;,</span><br><span class="line">            &quot;StartedAt&quot;: &quot;2023-02-18T09:58:54.860637695Z&quot;,</span><br><span class="line">            &quot;FinishedAt&quot;: &quot;2023-02-13T08:05:53.824258946Z&quot;</span><br><span class="line">        &#125;,</span><br><span class="line">        &quot;Image&quot;: &quot;sha256:b07e16b110887760e9f0a7e2d55c9a64c1d605309bddcd56c95749c91513d451&quot;,</span><br><span class="line">        &quot;ResolvConfPath&quot;: &quot;/var/lib/docker/containers/dcf25e61c13894a0d61870fcc1ad6a4cefcb531b00e9cd5fec5f7d54971d6871/resolv.conf&quot;,</span><br><span class="line">        &quot;HostnamePath&quot;: &quot;/var/lib/docker/containers/dcf25e61c13894a0d61870fcc1ad6a4cefcb531b00e9cd5fec5f7d54971d6871/hostname&quot;,</span><br><span class="line">        &quot;HostsPath&quot;: &quot;/var/lib/docker/containers/dcf25e61c13894a0d61870fcc1ad6a4cefcb531b00e9cd5fec5f7d54971d6871/hosts&quot;,</span><br><span class="line">        &quot;LogPath&quot;: &quot;/var/lib/docker/containers/dcf25e61c13894a0d61870fcc1ad6a4cefcb531b00e9cd5fec5f7d54971d6871/dcf25e61c13894a0d61870fcc1ad6a4cefcb531b00e9cd5fec5f7d54971d6871-json.log&quot;,</span><br><span class="line">        &quot;Name&quot;: &quot;/tomcat01&quot;,</span><br><span class="line">        &quot;RestartCount&quot;: 0,</span><br><span class="line">        &quot;Driver&quot;: &quot;overlay2&quot;,</span><br><span class="line">        &quot;Platform&quot;: &quot;linux&quot;,</span><br><span class="line">        &quot;MountLabel&quot;: &quot;&quot;,</span><br><span class="line">        &quot;ProcessLabel&quot;: &quot;&quot;,</span><br><span class="line">        &quot;AppArmorProfile&quot;: &quot;&quot;,</span><br><span class="line">        &quot;ExecIDs&quot;: null,</span><br><span class="line">        &quot;HostConfig&quot;: &#123;</span><br><span class="line">            &quot;Binds&quot;: null,</span><br><span class="line">            &quot;ContainerIDFile&quot;: &quot;&quot;,</span><br><span class="line">            &quot;LogConfig&quot;: &#123;</span><br><span class="line">                &quot;Type&quot;: &quot;json-file&quot;,</span><br><span class="line">                &quot;Config&quot;: &#123;&#125;</span><br><span class="line">            &#125;,</span><br><span class="line">            &quot;NetworkMode&quot;: &quot;default&quot;,</span><br><span class="line">            &quot;PortBindings&quot;: &#123;</span><br><span class="line">                &quot;8080/tcp&quot;: [</span><br><span class="line">                    &#123;</span><br><span class="line">                        &quot;HostIp&quot;: &quot;&quot;,</span><br><span class="line">                        &quot;HostPort&quot;: &quot;3355&quot;</span><br><span class="line">                    &#125;</span><br><span class="line">                ]</span><br><span class="line">            &#125;,</span><br><span class="line">            &quot;RestartPolicy&quot;: &#123;</span><br><span class="line">                &quot;Name&quot;: &quot;no&quot;,</span><br><span class="line">                &quot;MaximumRetryCount&quot;: 0</span><br><span class="line">            &#125;,</span><br><span class="line">            &quot;AutoRemove&quot;: false,</span><br><span class="line">            &quot;VolumeDriver&quot;: &quot;&quot;,</span><br><span class="line">            &quot;VolumesFrom&quot;: null,</span><br><span class="line">            &quot;ConsoleSize&quot;: [</span><br><span class="line">                25,</span><br><span class="line">                179</span><br><span class="line">            ],</span><br><span class="line">            &quot;CapAdd&quot;: null,</span><br><span class="line">            &quot;CapDrop&quot;: null,</span><br><span class="line">            &quot;CgroupnsMode&quot;: &quot;host&quot;,</span><br><span class="line">            &quot;Dns&quot;: [],</span><br><span class="line">            &quot;DnsOptions&quot;: [],</span><br><span class="line">            &quot;DnsSearch&quot;: [],</span><br><span class="line">            &quot;ExtraHosts&quot;: null,</span><br><span class="line">            &quot;GroupAdd&quot;: null,</span><br><span class="line">            &quot;IpcMode&quot;: &quot;private&quot;,</span><br><span class="line">            &quot;Cgroup&quot;: &quot;&quot;,</span><br><span class="line">            &quot;Links&quot;: null,</span><br><span class="line">            &quot;OomScoreAdj&quot;: 0,</span><br><span class="line">            &quot;PidMode&quot;: &quot;&quot;,</span><br><span class="line">            &quot;Privileged&quot;: false,</span><br><span class="line">            &quot;PublishAllPorts&quot;: false,</span><br><span class="line">            &quot;ReadonlyRootfs&quot;: false,</span><br><span class="line">            &quot;SecurityOpt&quot;: null,</span><br><span class="line">            &quot;UTSMode&quot;: &quot;&quot;,</span><br><span class="line">            &quot;UsernsMode&quot;: &quot;&quot;,</span><br><span class="line">            &quot;ShmSize&quot;: 67108864,</span><br><span class="line">            &quot;Runtime&quot;: &quot;runc&quot;,</span><br><span class="line">            &quot;Isolation&quot;: &quot;&quot;,</span><br><span class="line">            &quot;CpuShares&quot;: 0,</span><br><span class="line">            &quot;Memory&quot;: 0,</span><br><span class="line">            &quot;NanoCpus&quot;: 0,</span><br><span class="line">            &quot;CgroupParent&quot;: &quot;&quot;,</span><br><span class="line">            &quot;BlkioWeight&quot;: 0,</span><br><span class="line">            &quot;BlkioWeightDevice&quot;: [],</span><br><span class="line">            &quot;BlkioDeviceReadBps&quot;: [],</span><br><span class="line">            &quot;BlkioDeviceWriteBps&quot;: [],</span><br><span class="line">            &quot;BlkioDeviceReadIOps&quot;: [],</span><br><span class="line">            &quot;BlkioDeviceWriteIOps&quot;: [],</span><br><span class="line">            &quot;CpuPeriod&quot;: 0,</span><br><span class="line">            &quot;CpuQuota&quot;: 0,</span><br><span class="line">            &quot;CpuRealtimePeriod&quot;: 0,</span><br><span class="line">            &quot;CpuRealtimeRuntime&quot;: 0,</span><br><span class="line">            &quot;CpusetCpus&quot;: &quot;&quot;,</span><br><span class="line">            &quot;CpusetMems&quot;: &quot;&quot;,</span><br><span class="line">            &quot;Devices&quot;: [],</span><br><span class="line">            &quot;DeviceCgroupRules&quot;: null,</span><br><span class="line">            &quot;DeviceRequests&quot;: null,</span><br><span class="line">            &quot;MemoryReservation&quot;: 0,</span><br><span class="line">            &quot;MemorySwap&quot;: 0,</span><br><span class="line">            &quot;MemorySwappiness&quot;: null,</span><br><span class="line">            &quot;OomKillDisable&quot;: false,</span><br><span class="line">            &quot;PidsLimit&quot;: null,</span><br><span class="line">            &quot;Ulimits&quot;: null,</span><br><span class="line">            &quot;CpuCount&quot;: 0,</span><br><span class="line">            &quot;CpuPercent&quot;: 0,</span><br><span class="line">            &quot;IOMaximumIOps&quot;: 0,</span><br><span class="line">            &quot;IOMaximumBandwidth&quot;: 0,</span><br><span class="line">            &quot;MaskedPaths&quot;: [</span><br><span class="line">                &quot;/proc/asound&quot;,</span><br><span class="line">                &quot;/proc/acpi&quot;,</span><br><span class="line">                &quot;/proc/kcore&quot;,</span><br><span class="line">                &quot;/proc/keys&quot;,</span><br><span class="line">                &quot;/proc/latency_stats&quot;,</span><br><span class="line">                &quot;/proc/timer_list&quot;,</span><br><span class="line">                &quot;/proc/timer_stats&quot;,</span><br><span class="line">                &quot;/proc/sched_debug&quot;,</span><br><span class="line">                &quot;/proc/scsi&quot;,</span><br><span class="line">                &quot;/sys/firmware&quot;</span><br><span class="line">            ],</span><br><span class="line">            &quot;ReadonlyPaths&quot;: [</span><br><span class="line">                &quot;/proc/bus&quot;,</span><br><span class="line">                &quot;/proc/fs&quot;,</span><br><span class="line">                &quot;/proc/irq&quot;,</span><br><span class="line">                &quot;/proc/sys&quot;,</span><br><span class="line">                &quot;/proc/sysrq-trigger&quot;</span><br><span class="line">            ]</span><br><span class="line">        &#125;,</span><br><span class="line">        &quot;GraphDriver&quot;: &#123;</span><br><span class="line">            &quot;Data&quot;: &#123;</span><br><span class="line">                &quot;LowerDir&quot;: &quot;/var/lib/docker/overlay2/db58e0d55834b31ce6ef1e6e863fba188007e89f75a5b09597ac6fbcdbea8200-init/diff:/var/lib/docker/overlay2/ccdc5b6b5149fe15f86dbd7b223526471bd34b54adf2712dc516b8dfb47adb25/diff:/var/lib/docker/overlay2/d66bc61537a6126992e4e1de75b93bc9445864fd88e9b076834e72d04a928e70/diff:/var/lib/docker/overlay2/b75495e5bde09db6fd8735152a8c38fea408aa8aff1d1ebd07368e01e10c76fc/diff:/var/lib/docker/overlay2/e5105d9a6b73d9cce4b26ce79a7b7516189896aa6f78c3a0f2b37b571d753da8/diff:/var/lib/docker/overlay2/ce6466763d59debae0c1d1cbce8163318efb5dd385c5e79ef356610ffc9b9b93/diff:/var/lib/docker/overlay2/c22ea8305a7dc3d9536ea9cc8e922192e5b665c09424e2072feb589bce9c5a66/diff:/var/lib/docker/overlay2/63d30096d984ac8e42aafbc726d4907d7e1f8c3e4aeb63fc5e2df77783258548/diff&quot;,</span><br><span class="line">                &quot;MergedDir&quot;: &quot;/var/lib/docker/overlay2/db58e0d55834b31ce6ef1e6e863fba188007e89f75a5b09597ac6fbcdbea8200/merged&quot;,</span><br><span class="line">                &quot;UpperDir&quot;: &quot;/var/lib/docker/overlay2/db58e0d55834b31ce6ef1e6e863fba188007e89f75a5b09597ac6fbcdbea8200/diff&quot;,</span><br><span class="line">                &quot;WorkDir&quot;: &quot;/var/lib/docker/overlay2/db58e0d55834b31ce6ef1e6e863fba188007e89f75a5b09597ac6fbcdbea8200/work&quot;</span><br><span class="line">            &#125;,</span><br><span class="line">            &quot;Name&quot;: &quot;overlay2&quot;</span><br><span class="line">        &#125;,</span><br><span class="line">        &quot;Mounts&quot;: [],</span><br><span class="line">        &quot;Config&quot;: &#123;</span><br><span class="line">            &quot;Hostname&quot;: &quot;dcf25e61c138&quot;,</span><br><span class="line">            &quot;Domainname&quot;: &quot;&quot;,</span><br><span class="line">            &quot;User&quot;: &quot;&quot;,</span><br><span class="line">            &quot;AttachStdin&quot;: false,</span><br><span class="line">            &quot;AttachStdout&quot;: false,</span><br><span class="line">            &quot;AttachStderr&quot;: false,</span><br><span class="line">            &quot;ExposedPorts&quot;: &#123;</span><br><span class="line">                &quot;8080/tcp&quot;: &#123;&#125;</span><br><span class="line">            &#125;,</span><br><span class="line">            &quot;Tty&quot;: false,</span><br><span class="line">            &quot;OpenStdin&quot;: false,</span><br><span class="line">            &quot;StdinOnce&quot;: false,</span><br><span class="line">            &quot;Env&quot;: [</span><br><span class="line">                &quot;PATH=/usr/local/tomcat/bin:/opt/java/openjdk/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin&quot;,</span><br><span class="line">                &quot;JAVA_HOME=/opt/java/openjdk&quot;,</span><br><span class="line">                &quot;LANG=en_US.UTF-8&quot;,</span><br><span class="line">                &quot;LANGUAGE=en_US:en&quot;,</span><br><span class="line">                &quot;LC_ALL=en_US.UTF-8&quot;,</span><br><span class="line">                &quot;JAVA_VERSION=jdk-17.0.6+10&quot;,</span><br><span class="line">                &quot;CATALINA_HOME=/usr/local/tomcat&quot;,</span><br><span class="line">                &quot;TOMCAT_NATIVE_LIBDIR=/usr/local/tomcat/native-jni-lib&quot;,</span><br><span class="line">                &quot;LD_LIBRARY_PATH=/usr/local/tomcat/native-jni-lib&quot;,</span><br><span class="line">                &quot;GPG_KEYS=48F8E69F6390C9F25CFEDCD268248959359E722B A9C5DF4D22E99998D9875A5110C01C5A2F6059E7 DCFD35E0BF8CA7344752DE8B6FB21E8933C60243&quot;,</span><br><span class="line">                &quot;TOMCAT_MAJOR=9&quot;,</span><br><span class="line">                &quot;TOMCAT_VERSION=9.0.71&quot;,</span><br><span class="line">                &quot;TOMCAT_SHA512=6a747e68eff4b68a8defba111103ef6b1606030c180143de0419d015052a5567fca1a86e3d3e058a10246c02b98e89431e9344f80475189573fa0d5c70bfb4cb&quot;</span><br><span class="line">            ],</span><br><span class="line">            &quot;Cmd&quot;: [</span><br><span class="line">                &quot;catalina.sh&quot;,</span><br><span class="line">                &quot;run&quot;</span><br><span class="line">            ],</span><br><span class="line">            &quot;Image&quot;: &quot;tomcat:9.0&quot;,</span><br><span class="line">            &quot;Volumes&quot;: null,</span><br><span class="line">            &quot;WorkingDir&quot;: &quot;/usr/local/tomcat&quot;,</span><br><span class="line">            &quot;Entrypoint&quot;: null,</span><br><span class="line">            &quot;OnBuild&quot;: null,</span><br><span class="line">            &quot;Labels&quot;: &#123;</span><br><span class="line">                &quot;org.opencontainers.image.ref.name&quot;: &quot;ubuntu&quot;,</span><br><span class="line">                &quot;org.opencontainers.image.version&quot;: &quot;22.04&quot;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        &quot;NetworkSettings&quot;: &#123;</span><br><span class="line">            &quot;Bridge&quot;: &quot;&quot;,</span><br><span class="line">            &quot;SandboxID&quot;: &quot;f61dadfb0c6776bad36a53022bd2eeaa50ce4146618d34d921268c594658eb88&quot;,</span><br><span class="line">            &quot;HairpinMode&quot;: false,</span><br><span class="line">            &quot;LinkLocalIPv6Address&quot;: &quot;&quot;,</span><br><span class="line">            &quot;LinkLocalIPv6PrefixLen&quot;: 0,</span><br><span class="line">            &quot;Ports&quot;: &#123;</span><br><span class="line">                &quot;8080/tcp&quot;: [</span><br><span class="line">                    &#123;</span><br><span class="line">                        &quot;HostIp&quot;: &quot;0.0.0.0&quot;,</span><br><span class="line">                        &quot;HostPort&quot;: &quot;3355&quot;</span><br><span class="line">                    &#125;,</span><br><span class="line">                    &#123;</span><br><span class="line">                        &quot;HostIp&quot;: &quot;::&quot;,</span><br><span class="line">                        &quot;HostPort&quot;: &quot;3355&quot;</span><br><span class="line">                    &#125;</span><br><span class="line">                ]</span><br><span class="line">            &#125;,</span><br><span class="line">            &quot;SandboxKey&quot;: &quot;/var/run/docker/netns/f61dadfb0c67&quot;,</span><br><span class="line">            &quot;SecondaryIPAddresses&quot;: null,</span><br><span class="line">            &quot;SecondaryIPv6Addresses&quot;: null,</span><br><span class="line">            &quot;EndpointID&quot;: &quot;516a547df47472023b78d73c1a9fe9fdf2bfbcac22bd7b75c391cea567ac750f&quot;,</span><br><span class="line">            &quot;Gateway&quot;: &quot;172.17.0.1&quot;,</span><br><span class="line">            &quot;GlobalIPv6Address&quot;: &quot;&quot;,</span><br><span class="line">            &quot;GlobalIPv6PrefixLen&quot;: 0,</span><br><span class="line">            &quot;IPAddress&quot;: &quot;172.17.0.2&quot;,</span><br><span class="line">            &quot;IPPrefixLen&quot;: 16,</span><br><span class="line">            &quot;IPv6Gateway&quot;: &quot;&quot;,</span><br><span class="line">            &quot;MacAddress&quot;: &quot;02:42:ac:11:00:02&quot;,</span><br><span class="line">            &quot;Networks&quot;: &#123;</span><br><span class="line">                &quot;bridge&quot;: &#123;</span><br><span class="line">                    &quot;IPAMConfig&quot;: null,</span><br><span class="line">                    &quot;Links&quot;: null,</span><br><span class="line">                    &quot;Aliases&quot;: null,</span><br><span class="line">                    &quot;NetworkID&quot;: &quot;6fd7bb30e2a8bb6aa470d07f4e98f89c9d0bcbb1f48c60b40f53b2774b4da720&quot;,</span><br><span class="line">                    &quot;EndpointID&quot;: &quot;516a547df47472023b78d73c1a9fe9fdf2bfbcac22bd7b75c391cea567ac750f&quot;,</span><br><span class="line">                    &quot;Gateway&quot;: &quot;172.17.0.1&quot;,</span><br><span class="line">                    &quot;IPAddress&quot;: &quot;172.17.0.2&quot;,</span><br><span class="line">                    &quot;IPPrefixLen&quot;: 16,</span><br><span class="line">                    &quot;IPv6Gateway&quot;: &quot;&quot;,</span><br><span class="line">                    &quot;GlobalIPv6Address&quot;: &quot;&quot;,</span><br><span class="line">                    &quot;GlobalIPv6PrefixLen&quot;: 0,</span><br><span class="line">                    &quot;MacAddress&quot;: &quot;02:42:ac:11:00:02&quot;,</span><br><span class="line">                    &quot;DriverOpts&quot;: null</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">测试是否能ping通正在运行的tomcat容器</span></span><br><span class="line">[root@VM-16-5-centos /]# ping 172.17.0.2</span><br><span class="line">PING 172.17.0.2 (172.17.0.2) 56(84) bytes of data.</span><br><span class="line">64 bytes from 172.17.0.2: icmp_seq=1 ttl=64 time=0.055 ms</span><br><span class="line">64 bytes from 172.17.0.2: icmp_seq=2 ttl=64 time=0.032 ms</span><br><span class="line">64 bytes from 172.17.0.2: icmp_seq=3 ttl=64 time=0.032 ms</span><br><span class="line">64 bytes from 172.17.0.2: icmp_seq=4 ttl=64 time=0.043 ms</span><br><span class="line">^C</span><br><span class="line">--- 172.17.0.2 ping statistics ---</span><br><span class="line">4 packets transmitted, 4 received, 0% packet loss, time 3000ms</span><br><span class="line">rtt min/avg/max/mdev = 0.032/0.040/0.055/0.011 ms</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">linux可以ping通docker容器内部，因为我们每启动一个docker容器，docker就会给docker容器分配一个ip，我们只要安装了docker，就会有一个网卡docker0，桥接模式，使用veth-pair技术；</span></span><br></pre></td></tr></table></figure>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">测试docker内容器之间能否ping通，（结论：能通过容器ip来互相ping通）</span></span><br><span class="line">docker exec -it dcf25e61c138 ping 172.17.0.3</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>结论：1、Linux系统可以ping通容器内部；2、容器和容器之间可以ping通；3、容器之间是公用一个路由器，也就是docker0；4、容器停止或删除这个ip配置便失效了；</p>
<h3 id="—link"><a href="#—link" class="headerlink" title="—link"></a>—link</h3><blockquote>
<p>思考一个场景，我们编写了一个微服务，database url=ip，项目不重启，数据库ip换掉了，我们希望处理这个问题，可以名字来进行访问这个容器？</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">我们发现通过容器名字ping不通</span></span><br><span class="line">docker exec -it tomcat02 ping tomcat01</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">如何解决呢？通过--link</span></span><br><span class="line">docker exec -it tomcat02 --link tomcat01</span><br><span class="line">docker run -d -P --name tomcat03 --link tomcat01 tomcat:9.0</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">测试，发现tomcat02可以ping通tomcat01，tomcat03可以ping通tomcat01，但是这是单向的，反过来就不能ping通了。</span></span><br><span class="line">docker exec -it tomcat02 ping tomcat01 #成功</span><br><span class="line">docker exec -it tomcat03 ping tomcat01 #成功</span><br><span class="line">docker exec -it tomcat01 ping tomcat02 #失败</span><br><span class="line">docker exec -it tomcat01 ping tomcat03 #失败</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">查看docker里的网络</span></span><br><span class="line">[root@VM-16-5-centos /]# docker network COMMAND</span><br><span class="line"></span><br><span class="line">Usage:  docker network COMMAND</span><br><span class="line"></span><br><span class="line">Manage networks</span><br><span class="line"></span><br><span class="line">Commands:</span><br><span class="line">  connect     Connect a container to a network</span><br><span class="line">  create      Create a network</span><br><span class="line">  disconnect  Disconnect a container from a network</span><br><span class="line">  inspect     Display detailed information on one or more networks</span><br><span class="line">  ls          List networks</span><br><span class="line">  prune       Remove all unused networks</span><br><span class="line">  rm          Remove one or more networks</span><br><span class="line"></span><br><span class="line">Run &#x27;docker network COMMAND --help&#x27; for more information on a command.</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">查看所有网卡列表</span></span><br><span class="line">docker network ls</span><br><span class="line">[root@VM-16-5-centos /]# docker network ls</span><br><span class="line">NETWORK ID     NAME      DRIVER    SCOPE</span><br><span class="line">6fd7bb30e2a8   bridge    bridge    local</span><br><span class="line">03bbfbb9b664   host      host      local</span><br><span class="line">1b3e4d05081a   none      null      local</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">查看docker0网卡的ip配置信息</span></span><br><span class="line">docker network inspect networkID</span><br><span class="line">[root@VM-16-5-centos /]# docker network inspect 6fd7bb30e2a8</span><br><span class="line">[</span><br><span class="line">    &#123;</span><br><span class="line">        &quot;Name&quot;: &quot;bridge&quot;,</span><br><span class="line">        &quot;Id&quot;: &quot;6fd7bb30e2a8bb6aa470d07f4e98f89c9d0bcbb1f48c60b40f53b2774b4da720&quot;,</span><br><span class="line">        &quot;Created&quot;: &quot;2023-02-11T16:02:52.832137135+08:00&quot;,</span><br><span class="line">        &quot;Scope&quot;: &quot;local&quot;,</span><br><span class="line">        &quot;Driver&quot;: &quot;bridge&quot;,</span><br><span class="line">        &quot;EnableIPv6&quot;: false,</span><br><span class="line">        &quot;IPAM&quot;: &#123;</span><br><span class="line">            &quot;Driver&quot;: &quot;default&quot;,</span><br><span class="line">            &quot;Options&quot;: null,</span><br><span class="line">            &quot;Config&quot;: [</span><br><span class="line">                &#123;</span><br><span class="line">                    &quot;Subnet&quot;: &quot;172.17.0.0/16&quot;,</span><br><span class="line">                    &quot;Gateway&quot;: &quot;172.17.0.1&quot;</span><br><span class="line">                &#125;</span><br><span class="line">            ]</span><br><span class="line">        &#125;,</span><br><span class="line">        &quot;Internal&quot;: false,</span><br><span class="line">        &quot;Attachable&quot;: false,</span><br><span class="line">        &quot;Ingress&quot;: false,</span><br><span class="line">        &quot;ConfigFrom&quot;: &#123;</span><br><span class="line">            &quot;Network&quot;: &quot;&quot;</span><br><span class="line">        &#125;,</span><br><span class="line">        &quot;ConfigOnly&quot;: false,</span><br><span class="line">        &quot;Containers&quot;: &#123;</span><br><span class="line">            &quot;dcf25e61c13894a0d61870fcc1ad6a4cefcb531b00e9cd5fec5f7d54971d6871&quot;: &#123;</span><br><span class="line">                &quot;Name&quot;: &quot;tomcat01&quot;,</span><br><span class="line">                &quot;EndpointID&quot;: &quot;516a547df47472023b78d73c1a9fe9fdf2bfbcac22bd7b75c391cea567ac750f&quot;,</span><br><span class="line">                &quot;MacAddress&quot;: &quot;02:42:ac:11:00:02&quot;,</span><br><span class="line">                &quot;IPv4Address&quot;: &quot;172.17.0.2/16&quot;,</span><br><span class="line">                &quot;IPv6Address&quot;: &quot;&quot;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        &quot;Options&quot;: &#123;</span><br><span class="line">            &quot;com.docker.network.bridge.default_bridge&quot;: &quot;true&quot;,</span><br><span class="line">            &quot;com.docker.network.bridge.enable_icc&quot;: &quot;true&quot;,</span><br><span class="line">            &quot;com.docker.network.bridge.enable_ip_masquerade&quot;: &quot;true&quot;,</span><br><span class="line">            &quot;com.docker.network.bridge.host_binding_ipv4&quot;: &quot;0.0.0.0&quot;,</span><br><span class="line">            &quot;com.docker.network.bridge.name&quot;: &quot;docker0&quot;,</span><br><span class="line">            &quot;com.docker.network.driver.mtu&quot;: &quot;1500&quot;</span><br><span class="line">        &#125;,</span><br><span class="line">        &quot;Labels&quot;: &#123;&#125;</span><br><span class="line">    &#125;</span><br><span class="line">]</span><br></pre></td></tr></table></figure>
<p>—link只能单向映射，容器之间要互相连通，需要互相—link才行，非常麻烦，所以已经不建议—link了。</p>
<p>这时我们需要自定义网络，不使用docker0的网桥方式。</p>
<p>docker0的问题：它不支持容器名连接访问！</p>
<h3 id="自定义网络"><a href="#自定义网络" class="headerlink" title="自定义网络"></a>自定义网络</h3><blockquote>
<p>查看所有的docker网络</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">[root@VM-16-5-centos /]# docker network ls</span><br><span class="line">NETWORK ID     NAME      DRIVER    SCOPE</span><br><span class="line">6fd7bb30e2a8   bridge    bridge    local</span><br><span class="line">03bbfbb9b664   host      host      local</span><br><span class="line">1b3e4d05081a   none      null      local</span><br></pre></td></tr></table></figure>
<p><strong>网络模式</strong></p>
<ol>
<li>bridge(桥接模式)：桥接docker（默认）</li>
<li>none：不配置网络</li>
<li>host(主机模式)：和宿主机共享网络</li>
<li>container：容器网络连通（用的少！）</li>
</ol>
<p>我们自定义网络也使用桥接模式！</p>
<p><strong>测试</strong></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">[root@VM-16-5-centos /]# docker network --help</span><br><span class="line"></span><br><span class="line">Usage:  docker network COMMAND</span><br><span class="line"></span><br><span class="line">Manage networks</span><br><span class="line"></span><br><span class="line">Commands:</span><br><span class="line">  connect     Connect a container to a network</span><br><span class="line">  create      Create a network</span><br><span class="line">  disconnect  Disconnect a container from a network</span><br><span class="line">  inspect     Display detailed information on one or more networks</span><br><span class="line">  ls          List networks</span><br><span class="line">  prune       Remove all unused networks</span><br><span class="line">  rm          Remove one or more networks</span><br><span class="line"></span><br><span class="line">Run &#x27;docker network COMMAND --help&#x27; for more information on a command.</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">我们直接启动的命令 --net bridge ，而这个就是我们的docker0</span></span><br><span class="line">docker run -d -P --name tomcat01 tomcat:9.0</span><br><span class="line">docker run -d -P --name tomcat01 --net bridge tomcat:9.0  #与上一条命令一样的效果，因为默认就是使用docker0的桥接模式</span><br><span class="line"><span class="meta">#</span><span class="bash">docker0特点：默认，容器名不能访问，--link可以打通连接！</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">我们可以自定义网络！</span></span><br><span class="line"><span class="meta">#</span><span class="bash">查看创建网络的命令怎样使用</span></span><br><span class="line">[root@VM-16-5-centos /]# docker network create --help</span><br><span class="line"></span><br><span class="line">Usage:  docker network create [OPTIONS] NETWORK</span><br><span class="line"></span><br><span class="line">Create a network</span><br><span class="line"></span><br><span class="line">Options:</span><br><span class="line">      --attachable           Enable manual container attachment</span><br><span class="line">      --aux-address map      Auxiliary IPv4 or IPv6 addresses used by Network driver (default map[])</span><br><span class="line">      --config-from string   The network from which to copy the configuration</span><br><span class="line">      --config-only          Create a configuration only network</span><br><span class="line">  -d, --driver string        Driver to manage the Network (default &quot;bridge&quot;)</span><br><span class="line">      --gateway strings      IPv4 or IPv6 Gateway for the master subnet</span><br><span class="line">      --ingress              Create swarm routing-mesh network</span><br><span class="line">      --internal             Restrict external access to the network</span><br><span class="line">      --ip-range strings     Allocate container ip from a sub-range</span><br><span class="line">      --ipam-driver string   IP Address Management Driver (default &quot;default&quot;)</span><br><span class="line">      --ipam-opt map         Set IPAM driver specific options (default map[])</span><br><span class="line">      --ipv6                 Enable IPv6 networking</span><br><span class="line">      --label list           Set metadata on a network</span><br><span class="line">  -o, --opt map              Set driver specific options (default map[])</span><br><span class="line">      --scope string         Control the network&#x27;s scope</span><br><span class="line">      --subnet strings       Subnet in CIDR format that represents a network segment</span><br><span class="line">      </span><br><span class="line">      </span><br><span class="line"><span class="meta">#</span><span class="bash">--driver bridge                   bridge桥接模式</span></span><br><span class="line"><span class="meta">#</span><span class="bash">--subnet 192.168.0.0/16           子网地址</span></span><br><span class="line"><span class="meta">#</span><span class="bash">--gateway 192.168.0.1             网关地址</span></span><br><span class="line"><span class="meta">#</span><span class="bash">创建一个叫mynet的网络</span></span><br><span class="line">docker network create --driver bridge --subnet 192.168.0.0/16 --gateway 192.168.0.1 mynet</span><br><span class="line"><span class="meta">#</span><span class="bash">查看一下创建的网络</span></span><br><span class="line">docker network ls</span><br><span class="line">docker network inspect mynet</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">容器使用自定义的网络</span></span><br><span class="line">docker run -d -P --name tomcat01 --net mynet tomcat:9.0</span><br><span class="line">docker run -d -P --name tomcat02 --net mynet tomcat:9.0</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">现在互相ping,发现不管是ping的 ip 还是 容器名 都是可直接互相访问的。实现了容器互相访问，但修复了docker0的缺点。</span></span><br><span class="line">docker exec -it tomcat01 ping 192.168.0.3</span><br><span class="line">docker exec -it tomcat02 ping 192.168.0.2</span><br><span class="line">docker exec -it tomcat01 ping tomcat02</span><br><span class="line">docker exec -it tomcat02 ping tomcat01</span><br><span class="line"><span class="meta">#</span><span class="bash">我们自定义的网络docker都已经帮我们维护好了对应的关系，推荐我们平时这样使用网络！</span></span><br></pre></td></tr></table></figure>
<p>好处：</p>
<p>Redis—不同的集群使用不同的网络，保证集群是安全和健康的</p>
<p>MySQL—不同的集群使用不同的网络，保证集群是安全和健康的</p>
<h3 id="网络连通"><a href="#网络连通" class="headerlink" title="网络连通"></a>网络连通</h3><blockquote>
<p>问题：docker0与自定义网络之间不能ping通。也就是不同网络之间的容器是不能直接连通的。这时候就需要进行网络连通，容器跟网络之间的打通。</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">查看docker网络指令</span></span><br><span class="line">[root@VM-16-5-centos /]# docker network COMMAND</span><br><span class="line"></span><br><span class="line">Usage:  docker network COMMAND</span><br><span class="line"></span><br><span class="line">Manage networks</span><br><span class="line"></span><br><span class="line">Commands:</span><br><span class="line">  connect     Connect a container to a network</span><br><span class="line">  create      Create a network</span><br><span class="line">  disconnect  Disconnect a container from a network</span><br><span class="line">  inspect     Display detailed information on one or more networks</span><br><span class="line">  ls          List networks</span><br><span class="line">  prune       Remove all unused networks</span><br><span class="line">  rm          Remove one or more networks</span><br><span class="line"></span><br><span class="line">Run &#x27;docker network COMMAND --help&#x27; for more information on a command.</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">使用connect指令进行网络连通</span></span><br><span class="line"><span class="meta">#</span><span class="bash">查看connect指令用法</span></span><br><span class="line">[root@VM-16-5-centos /]# docker network connect --help</span><br><span class="line"></span><br><span class="line">Usage:  docker network connect [OPTIONS] NETWORK CONTAINER</span><br><span class="line"></span><br><span class="line">Connect a container to a network</span><br><span class="line"></span><br><span class="line">Options:</span><br><span class="line">      --alias strings           Add network-scoped alias for the container</span><br><span class="line">      --driver-opt strings      driver options for the network</span><br><span class="line">      --ip string               IPv4 address (e.g., &quot;172.30.100.104&quot;)</span><br><span class="line">      --ip6 string              IPv6 address (e.g., &quot;2001:db8::33&quot;)</span><br><span class="line">      --link list               Add link to another container</span><br><span class="line">      --link-local-ip strings   Add a link-local address for the container</span><br><span class="line"><span class="meta">#</span><span class="bash">connect指令进行网络连通</span></span><br><span class="line">docker network connect mynet tomcat01</span><br><span class="line"><span class="meta">#</span><span class="bash">连通之后通过docker network inspect mynet命令可以看到mynet网络直接将tomcat01添加到了此网络中。</span></span><br><span class="line"><span class="meta">#</span><span class="bash">一个容器两个ip地址</span></span><br><span class="line"><span class="meta">#</span><span class="bash">此时使用ping 命令可以发现tomcat01可以连通mynet网络的容器。</span></span><br></pre></td></tr></table></figure>
<h3 id="实战：部署Redis集群"><a href="#实战：部署Redis集群" class="headerlink" title="实战：部署Redis集群"></a>实战：部署Redis集群</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">创建一个加redis的网卡</span></span><br><span class="line">docker network create redis --subnet 172.38.0.0/16</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">查看创建的网卡</span></span><br><span class="line">[root@VM-16-5-centos /]# docker network ls</span><br><span class="line">NETWORK ID     NAME      DRIVER    SCOPE</span><br><span class="line">6fd7bb30e2a8   bridge    bridge    local</span><br><span class="line">03bbfbb9b664   host      host      local</span><br><span class="line">1b3e4d05081a   none      null      local</span><br><span class="line">e6ef4403e005   redis     bridge    local</span><br><span class="line"><span class="meta">#</span><span class="bash">查看网卡信息</span></span><br><span class="line">[root@VM-16-5-centos /]# docker network inspect redis</span><br><span class="line">[</span><br><span class="line">    &#123;</span><br><span class="line">        &quot;Name&quot;: &quot;redis&quot;,</span><br><span class="line">        &quot;Id&quot;: &quot;e6ef4403e005712f4accddf84049956edb37ecf157eeb9993fced0c08b3354a5&quot;,</span><br><span class="line">        &quot;Created&quot;: &quot;2023-02-19T13:16:27.470782749+08:00&quot;,</span><br><span class="line">        &quot;Scope&quot;: &quot;local&quot;,</span><br><span class="line">        &quot;Driver&quot;: &quot;bridge&quot;,</span><br><span class="line">        &quot;EnableIPv6&quot;: false,</span><br><span class="line">        &quot;IPAM&quot;: &#123;</span><br><span class="line">            &quot;Driver&quot;: &quot;default&quot;,</span><br><span class="line">            &quot;Options&quot;: &#123;&#125;,</span><br><span class="line">            &quot;Config&quot;: [</span><br><span class="line">                &#123;</span><br><span class="line">                    &quot;Subnet&quot;: &quot;172.38.0.0/16&quot;</span><br><span class="line">                &#125;</span><br><span class="line">            ]</span><br><span class="line">        &#125;,</span><br><span class="line">        &quot;Internal&quot;: false,</span><br><span class="line">        &quot;Attachable&quot;: false,</span><br><span class="line">        &quot;Ingress&quot;: false,</span><br><span class="line">        &quot;ConfigFrom&quot;: &#123;</span><br><span class="line">            &quot;Network&quot;: &quot;&quot;</span><br><span class="line">        &#125;,</span><br><span class="line">        &quot;ConfigOnly&quot;: false,</span><br><span class="line">        &quot;Containers&quot;: &#123;&#125;,</span><br><span class="line">        &quot;Options&quot;: &#123;&#125;,</span><br><span class="line">        &quot;Labels&quot;: &#123;&#125;</span><br><span class="line">    &#125;</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">通过脚本创建六个Redis配置</span></span><br><span class="line">for port in $(seq 1 6); \</span><br><span class="line">do \</span><br><span class="line">mkdir -p /mydata/redis/node-$&#123;port&#125;/conf</span><br><span class="line">touch /mydata/redis/node-$&#123;port&#125;/conf/redis.conf</span><br><span class="line">cat &lt;&lt; EOF &gt;/mydata/redis/node-$&#123;port&#125;/conf/redis.conf</span><br><span class="line">port 6379</span><br><span class="line">bind 0.0.0.0</span><br><span class="line">cluster-enabled yes</span><br><span class="line">cluster-config-file nodes.conf</span><br><span class="line">cluster-node-timeout 5000</span><br><span class="line">cluster-announce-ip 172.38.0.1$&#123;port&#125;</span><br><span class="line">cluster-announce-port 6379</span><br><span class="line">cluster-announce-bus-port 16379</span><br><span class="line">appendonly yes</span><br><span class="line">EOF</span><br><span class="line">done</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">查看是否创建成功，可以看到已经创建了6个Redis配置文件</span></span><br><span class="line">[root@VM-16-5-centos /]# cd /mydata</span><br><span class="line">[root@VM-16-5-centos mydata]# ls</span><br><span class="line">redis</span><br><span class="line">[root@VM-16-5-centos mydata]# cd redis</span><br><span class="line">[root@VM-16-5-centos redis]# ll</span><br><span class="line">total 24</span><br><span class="line">drwxr-xr-x 3 root root 4096 Feb 19 13:32 node-1</span><br><span class="line">drwxr-xr-x 3 root root 4096 Feb 19 13:32 node-2</span><br><span class="line">drwxr-xr-x 3 root root 4096 Feb 19 13:32 node-3</span><br><span class="line">drwxr-xr-x 3 root root 4096 Feb 19 13:32 node-4</span><br><span class="line">drwxr-xr-x 3 root root 4096 Feb 19 13:32 node-5</span><br><span class="line">drwxr-xr-x 3 root root 4096 Feb 19 13:32 node-6</span><br><span class="line">[root@VM-16-5-centos redis]# cd node-1/conf</span><br><span class="line">[root@VM-16-5-centos conf]# ll</span><br><span class="line">total 4</span><br><span class="line">-rw-r--r-- 1 root root 206 Feb 19 13:32 redis.conf</span><br><span class="line">[root@VM-16-5-centos conf]# cat redis.conf</span><br><span class="line">port 6379</span><br><span class="line">bind 0.0.0.0</span><br><span class="line">cluster-enabled yes</span><br><span class="line">cluster-config-file nodes.conf</span><br><span class="line">cluster-node-timeout 5000</span><br><span class="line">cluster-announce-ip 172.38.0.11</span><br><span class="line">cluster-announce-port 6379</span><br><span class="line">cluster-announce-bus-port 16379</span><br><span class="line">appendonly yes</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 启动六个Redis容器</span></span><br><span class="line"><span class="meta">#</span><span class="bash">模板</span></span><br><span class="line">docker run -p 637$&#123;port&#125;:6379 -p 1637$&#123;port&#125;:16379 --name redis-$&#123;port&#125; \</span><br><span class="line">-v /mydata/redis/node-$&#123;port&#125;/data:/data \</span><br><span class="line">-v /mydata/redis/node-$&#123;port&#125;/conf/redis.conf:/etc/redis/redis.conf \</span><br><span class="line">-d --net redis --ip 172.38.0.1$&#123;port&#125; redis:6.0 redis-server /etc/redis/redis.conf</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span></span><br><span class="line"><span class="bash">docker run -p 6371:6379 -p 16371:16379 --name redis-1 \</span></span><br><span class="line"><span class="bash">-v /mydata/redis/node-1/data:/data \</span></span><br><span class="line"><span class="bash">-v /mydata/redis/node-1/conf/redis.conf:/etc/redis/redis.conf \</span></span><br><span class="line"><span class="bash">-d --net redis --ip 172.38.0.11 redis:6.0 redis-server /etc/redis/redis.conf</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span></span><br><span class="line"><span class="bash">docker run -p 6376:6379 -p 16376:16379 --name redis-6 \</span></span><br><span class="line"><span class="bash">-v /mydata/redis/node-6/data:/data \</span></span><br><span class="line"><span class="bash">-v /mydata/redis/node-6/conf/redis.conf:/etc/redis/redis.conf \</span></span><br><span class="line"><span class="bash">-d --net redis --ip 172.38.0.16 redis:6.0 redis-server /etc/redis/redis.conf</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">进入redis-1容器</span></span><br><span class="line">docker exec -it redis-1 /bin/sh</span><br><span class="line">ls #可以看到appendonly.aof持久化配置文件和nodes.conf节点配置文件</span><br><span class="line"><span class="meta">#</span><span class="bash">创建一个集群</span></span><br><span class="line">redis-cli --cluster create 172.38.0.11:6379 172.38.0.12:6379 172.38.0.13:6379 172.38.0.14:6379 172.38.0.15:6379 172.38.0.16:6379 --cluster-replicas 1</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">演示结果</span></span><br><span class="line">[root@VM-16-5-centos /]# docker exec -it redis-1 /bin/sh</span><br><span class="line"><span class="meta">#</span><span class="bash"> ls</span></span><br><span class="line">appendonly.aof  nodes.conf</span><br><span class="line"><span class="meta">#</span><span class="bash"> redis-cli --cluster create 172.38.0.11:6379 172.38.0.12:6379 172.38.0.13:6379 172.38.0.14:6379 172.38.0.15:6379 172.38.0.16:6379 --cluster-replicas 1</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash">&gt;&gt; Performing <span class="built_in">hash</span> slots allocation on 6 nodes...</span></span><br><span class="line">Master[0] -&gt; Slots 0 - 5460</span><br><span class="line">Master[1] -&gt; Slots 5461 - 10922</span><br><span class="line">Master[2] -&gt; Slots 10923 - 16383</span><br><span class="line">Adding replica 172.38.0.15:6379 to 172.38.0.11:6379</span><br><span class="line">Adding replica 172.38.0.16:6379 to 172.38.0.12:6379</span><br><span class="line">Adding replica 172.38.0.14:6379 to 172.38.0.13:6379</span><br><span class="line">M: a2f87397ea9742d9e6c37406b68229e54e5e2930 172.38.0.11:6379</span><br><span class="line">   slots:[0-5460] (5461 slots) master</span><br><span class="line">M: 43ae87e93995d5e2a6daf9c085cb287e386da50e 172.38.0.12:6379</span><br><span class="line">   slots:[5461-10922] (5462 slots) master</span><br><span class="line">M: b4f29f904038f8657f160cfaedc6882f147c9b90 172.38.0.13:6379</span><br><span class="line">   slots:[10923-16383] (5461 slots) master</span><br><span class="line">S: 34ed53f1ee51b99acbf5df8f948f7c1b5d89d9bf 172.38.0.14:6379</span><br><span class="line">   replicates b4f29f904038f8657f160cfaedc6882f147c9b90</span><br><span class="line">S: 95038905f2e00ed28cb6e53760e5b5100bafad2e 172.38.0.15:6379</span><br><span class="line">   replicates a2f87397ea9742d9e6c37406b68229e54e5e2930</span><br><span class="line">S: 6abd725c56b4d745e9873b3f584658314c97f568 172.38.0.16:6379</span><br><span class="line">   replicates 43ae87e93995d5e2a6daf9c085cb287e386da50e</span><br><span class="line">Can I set the above configuration? (type &#x27;yes&#x27; to accept): yes</span><br><span class="line"><span class="meta">&gt;</span><span class="bash">&gt;&gt; Nodes configuration updated</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash">&gt;&gt; Assign a different config epoch to each node</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash">&gt;&gt; Sending CLUSTER MEET messages to join the cluster</span></span><br><span class="line">Waiting for the cluster to join</span><br><span class="line">.</span><br><span class="line"><span class="meta">&gt;</span><span class="bash">&gt;&gt; Performing Cluster Check (using node 172.38.0.11:6379)</span></span><br><span class="line">M: a2f87397ea9742d9e6c37406b68229e54e5e2930 172.38.0.11:6379</span><br><span class="line">   slots:[0-5460] (5461 slots) master</span><br><span class="line">   1 additional replica(s)</span><br><span class="line">M: 43ae87e93995d5e2a6daf9c085cb287e386da50e 172.38.0.12:6379</span><br><span class="line">   slots:[5461-10922] (5462 slots) master</span><br><span class="line">   1 additional replica(s)</span><br><span class="line">S: 6abd725c56b4d745e9873b3f584658314c97f568 172.38.0.16:6379</span><br><span class="line">   slots: (0 slots) slave</span><br><span class="line">   replicates 43ae87e93995d5e2a6daf9c085cb287e386da50e</span><br><span class="line">S: 34ed53f1ee51b99acbf5df8f948f7c1b5d89d9bf 172.38.0.14:6379</span><br><span class="line">   slots: (0 slots) slave</span><br><span class="line">   replicates b4f29f904038f8657f160cfaedc6882f147c9b90</span><br><span class="line">M: b4f29f904038f8657f160cfaedc6882f147c9b90 172.38.0.13:6379</span><br><span class="line">   slots:[10923-16383] (5461 slots) master</span><br><span class="line">   1 additional replica(s)</span><br><span class="line">S: 95038905f2e00ed28cb6e53760e5b5100bafad2e 172.38.0.15:6379</span><br><span class="line">   slots: (0 slots) slave</span><br><span class="line">   replicates a2f87397ea9742d9e6c37406b68229e54e5e2930</span><br><span class="line">[OK] All nodes agree about slots configuration.</span><br><span class="line"><span class="meta">&gt;</span><span class="bash">&gt;&gt; Check <span class="keyword">for</span> open slots...</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash">&gt;&gt; Check slots coverage...</span></span><br><span class="line">[OK] All 16384 slots covered.</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">查看集群信息</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> redis-cli -c <span class="comment">#进入集群</span></span></span><br><span class="line">127.0.0.1:6379&gt; cluster info #查看集群信息</span><br><span class="line">cluster_state:ok</span><br><span class="line">cluster_slots_assigned:16384</span><br><span class="line">cluster_slots_ok:16384</span><br><span class="line">cluster_slots_pfail:0</span><br><span class="line">cluster_slots_fail:0</span><br><span class="line">cluster_known_nodes:6</span><br><span class="line">cluster_size:3</span><br><span class="line">cluster_current_epoch:6</span><br><span class="line">cluster_my_epoch:1</span><br><span class="line">cluster_stats_messages_ping_sent:504</span><br><span class="line">cluster_stats_messages_pong_sent:510</span><br><span class="line">cluster_stats_messages_sent:1014</span><br><span class="line">cluster_stats_messages_ping_received:505</span><br><span class="line">cluster_stats_messages_pong_received:504</span><br><span class="line">cluster_stats_messages_meet_received:5</span><br><span class="line">cluster_stats_messages_received:1014</span><br><span class="line">127.0.0.1:6379&gt; cluster nodes #查看集群节点</span><br><span class="line">43ae87e93995d5e2a6daf9c085cb287e386da50e 172.38.0.12:6379@16379 master - 0 1676788078000 2 connected 5461-10922</span><br><span class="line">6abd725c56b4d745e9873b3f584658314c97f568 172.38.0.16:6379@16379 slave 43ae87e93995d5e2a6daf9c085cb287e386da50e 0 1676788077000 2 connected</span><br><span class="line">34ed53f1ee51b99acbf5df8f948f7c1b5d89d9bf 172.38.0.14:6379@16379 slave b4f29f904038f8657f160cfaedc6882f147c9b90 0 1676788076597 3 connected</span><br><span class="line">b4f29f904038f8657f160cfaedc6882f147c9b90 172.38.0.13:6379@16379 master - 0 1676788078100 3 connected 10923-16383</span><br><span class="line">95038905f2e00ed28cb6e53760e5b5100bafad2e 172.38.0.15:6379@16379 slave a2f87397ea9742d9e6c37406b68229e54e5e2930 0 1676788077699 1 connected</span><br><span class="line">a2f87397ea9742d9e6c37406b68229e54e5e2930 172.38.0.11:6379@16379 myself,master - 0 1676788077000 1 connected 0-5460</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">测试</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> <span class="built_in">set</span> a b</span></span><br><span class="line"><span class="meta">#</span><span class="bash">然后将存储的节点容器停止，然后测试</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> get a</span></span><br><span class="line"><span class="meta">#</span><span class="bash">可以发现是从副节点取得的值，集群搭建成功</span></span><br></pre></td></tr></table></figure>
<h2 id="SpringBoot微服务打包Docker镜像"><a href="#SpringBoot微服务打包Docker镜像" class="headerlink" title="SpringBoot微服务打包Docker镜像"></a>SpringBoot微服务打包Docker镜像</h2><p>1、构建springboot项目</p>
<p>2、打包应用</p>
<p>3、编写dockerfile</p>
<p>4、构建镜像</p>
<p>5、发布运行</p>
<h2 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h2><p>做完上述实验测试需要删除的数据挂载目录有：</p>
<p>/home/mysql————mysql目录及目录下的所有文件</p>
<p>/mydata———————-mydata目录及目录下的所有文件</p>
<p>做完上述实验测试需要删除的docker网络有：redis</p>
</article><div class="post-copyright"><div class="post-copyright__title"><span class="post-copyright-info"><h>Docker基础入门</h></span></div><div class="post-copyright__type"><span class="post-copyright-info"><a href="http://qianchenggit.github.io/2023/02/12/Docker%E5%9F%BA%E7%A1%80%E5%85%A5%E9%97%A8/">http://qianchenggit.github.io/2023/02/12/Docker基础入门/</a></span></div><div class="post-copyright-m"><div class="post-copyright-m-info"><div class="post-copyright-a"><h>作者</h><div class="post-copyright-cc-info"><h>QianChengGit</h></div></div><div class="post-copyright-c"><h>发布于</h><div class="post-copyright-cc-info"><h>2023-02-12</h></div></div><div class="post-copyright-u"><h>更新于</h><div class="post-copyright-cc-info"><h>2023-02-12</h></div></div><div class="post-copyright-c"><h>许可协议</h><div class="post-copyright-cc-info"><a class="icon" rel="noopener" target="_blank" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a><a rel="noopener" target="_blank" title="CC BY-NC-SA 4.0" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a></div></div></div></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Docker/">Docker</a></div><div class="post_share"><div class="social-share" data-image="https://i.loli.net/2021/03/07/HoXI7C2NtdguaBw.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><div class="post-reward"><div class="reward-button button--animated"><i class="fas fa-qrcode"></i> 打赏</div><div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="/img/wechat.png" target="_blank"><img class="post-qr-code-img" data-lazy-src="/img/wechat.png" alt="微信"/></a><div class="post-qr-code-desc">微信</div></li><li class="reward-item"><a href="/img/alipay.jpg" target="_blank"><img class="post-qr-code-img" data-lazy-src="/img/alipay.jpg" alt="支付宝"/></a><div class="post-qr-code-desc">支付宝</div></li></ul></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-full"><a href="/2022/09/08/Vue2%E4%BD%BF%E7%94%A8Echarts/"><img class="prev-cover" data-lazy-src="https://i.loli.net/2021/03/07/HoXI7C2NtdguaBw.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">Vue2使用Echarts</div></div></a></div></nav><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div id="gitalk-container"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Docker%E5%9F%BA%E7%A1%80%E5%85%A5%E9%97%A8"><span class="toc-text">Docker基础入门</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%80%E3%80%81CentOS7%E5%AE%89%E8%A3%85Docker"><span class="toc-text">一、CentOS7安装Docker</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8C%E3%80%81Docker%E7%9A%84%E5%9F%BA%E6%9C%AC%E5%91%BD%E4%BB%A4"><span class="toc-text">二、Docker的基本命令</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B8%AE%E5%8A%A9%E5%91%BD%E4%BB%A4"><span class="toc-text">帮助命令</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%95%9C%E5%83%8F%E5%91%BD%E4%BB%A4"><span class="toc-text">镜像命令</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%B9%E5%99%A8%E5%91%BD%E4%BB%A4"><span class="toc-text">容器命令</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%89%E3%80%81%E5%B8%B8%E7%94%A8%E5%85%B6%E4%BB%96%E5%91%BD%E4%BB%A4"><span class="toc-text">三、常用其他命令</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9B%9B%E3%80%81%E4%BD%9C%E4%B8%9A%E7%BB%83%E4%B9%A0"><span class="toc-text">四、作业练习</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-docker%E5%AE%89%E8%A3%85nginx"><span class="toc-text">1.docker安装nginx</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2%E3%80%81docker%E5%AE%89%E8%A3%85tomcat"><span class="toc-text">2、docker安装tomcat</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3%E3%80%81docker%E5%AE%89%E8%A3%85portainer"><span class="toc-text">3、docker安装portainer</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%94%E3%80%81Docker%E9%95%9C%E5%83%8F%E8%AE%B2%E8%A7%A3"><span class="toc-text">五、Docker镜像讲解</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1%E3%80%81commit%E9%95%9C%E5%83%8F"><span class="toc-text">1、commit镜像</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%AD%E3%80%81%E5%AE%B9%E5%99%A8%E6%95%B0%E6%8D%AE%E5%8D%B7"><span class="toc-text">六、容器数据卷</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%9E%E6%88%98%EF%BC%9ADocker%E5%AE%89%E8%A3%85MySQL"><span class="toc-text">实战：Docker安装MySQL</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%B7%E5%90%8D%E5%92%8C%E5%8C%BF%E5%90%8D%E6%8C%82%E8%BD%BD"><span class="toc-text">具名和匿名挂载</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%9D%E8%AF%86Dockerfile"><span class="toc-text">初识Dockerfile</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%80%9A%E8%BF%87%E8%84%9A%E6%9C%AC%E7%94%9F%E6%88%90%E9%95%9C%E5%83%8F"><span class="toc-text">通过脚本生成镜像</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%8D%B7%E5%AE%B9%E5%99%A8"><span class="toc-text">数据卷容器</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%83%E3%80%81Dockerfile"><span class="toc-text">七、Dockerfile</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Dockerfile%E7%9A%84%E6%8C%87%E4%BB%A4"><span class="toc-text">Dockerfile的指令</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%9E%E6%88%98%E6%B5%8B%E8%AF%95"><span class="toc-text">实战测试</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%91%E5%B8%83%E8%87%AA%E5%B7%B1%E7%9A%84%E9%95%9C%E5%83%8F"><span class="toc-text">发布自己的镜像</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%AB%E3%80%81Docker%E7%BD%91%E7%BB%9C"><span class="toc-text">八、Docker网络</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%90%86%E8%A7%A3Docker0"><span class="toc-text">理解Docker0</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E2%80%94link"><span class="toc-text">—link</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%87%AA%E5%AE%9A%E4%B9%89%E7%BD%91%E7%BB%9C"><span class="toc-text">自定义网络</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BD%91%E7%BB%9C%E8%BF%9E%E9%80%9A"><span class="toc-text">网络连通</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%9E%E6%88%98%EF%BC%9A%E9%83%A8%E7%BD%B2Redis%E9%9B%86%E7%BE%A4"><span class="toc-text">实战：部署Redis集群</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SpringBoot%E5%BE%AE%E6%9C%8D%E5%8A%A1%E6%89%93%E5%8C%85Docker%E9%95%9C%E5%83%8F"><span class="toc-text">SpringBoot微服务打包Docker镜像</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B0%8F%E7%BB%93"><span class="toc-text">小结</span></a></li></ol></li></ol></div></div></div></div></main><footer id="footer" style="background: transparent"><div id="footer-wrap"><div class="copyright"><span>&copy;2020 - 2023</span><svg style="width:1.5em; height:1.5em" aria-hidden="true"><use xlink:href="#icon-Butterfly"></use></svg><span>QianChengGit</span></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="font-plus" type="button" title="放大字体"><i class="fas fa-plus"></i></button><button id="font-minus" type="button" title="缩小字体"><i class="fas fa-minus"></i></button><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="chat_btn" type="button" title="rightside.chat_btn"><i class="fas fa-sms"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><div class="search-dialog__title" id="local-search-title">本地搜索</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div></div><hr/><div id="local-search-results"></div><span class="search-close-button"><i class="fas fa-times"></i></span></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload/dist/lazyload.iife.min.js"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><script>function panguFn () {
  if (typeof pangu === 'object') pangu.autoSpacingPage()
  else {
    getScript('https://cdn.jsdelivr.net/npm/pangu/dist/browser/pangu.min.js')
      .then(() => {
        pangu.autoSpacingPage()
      })
  }
}

function panguInit () {
  if (false){
    GLOBAL_CONFIG_SITE.isPost && panguFn()
  } else {
    panguFn()
  }
}

document.addEventListener('DOMContentLoaded', panguInit)</script><script src="/js/search/local-search.js"></script><script>var preloader = {
  endLoading: () => {
    document.body.style.overflow = 'auto';
    document.getElementById('loading-box').classList.add("loaded")
  },
  initLoading: () => {
    document.body.style.overflow = '';
    document.getElementById('loading-box').classList.remove("loaded")

  }
}
window.addEventListener('load',preloader.endLoading())</script><div class="js-pjax"><script>if (document.getElementsByClassName('mermaid').length) {
  if (window.mermaidJsLoad) mermaid.init()
  else {
    getScript('https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js').then(() => {
      window.mermaidJsLoad = true
      mermaid.initialize({
        theme: 'default',
      })
      false && mermaid.init()
    })
  }
}</script><script>function addGitalkSource () {
  const ele = document.createElement('link')
  ele.rel = 'stylesheet'
  ele.href= 'https://cdn.jsdelivr.net/npm/gitalk/dist/gitalk.min.css'
  document.getElementsByTagName('head')[0].appendChild(ele)
}

function loadGitalk () {
  function initGitalk () {
    var gitalk = new Gitalk({
      clientID: '93dcec7c7b4eb1aa3bfb',
      clientSecret: '3f2d196e606df62f31b6b68fd3d57ee0da950391',
      repo: 'QianChengGit.github.io',
      owner: 'QianChengGit',
      admin: ['QianChengGit'],
      id: '4e2aa26b0cd0ff6bd2cb1e77d0b8b590',
      language: 'zh-CN',
      perPage: 10,
      distractionFreeMode: true,
      pagerDirection: 'last',
      createIssueManually: false,
      updateCountCallback: commentCount
    })
    gitalk.render('gitalk-container')
  }

  if (typeof Gitalk === 'function') initGitalk()
  else {
    addGitalkSource()
    getScript('https://cdn.jsdelivr.net/npm/gitalk@latest/dist/gitalk.min.js').then(initGitalk)
  }
}

function commentCount(n){
  let isCommentCount = document.querySelector('#post-meta .gitalk-comment-count')
  if (isCommentCount) {
    isCommentCount.innerHTML= n
  }
}

if ('Gitalk' === 'Gitalk' || !true) {
  if (true) btf.loadComment(document.getElementById('gitalk-container'), loadGitalk)
  else loadGitalk()
} else {
  function loadOtherComment () {
    loadGitalk()
  }
}</script></div><script async src="/js/diytitle.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = false;
POWERMODE.mobile = false;
document.body.addEventListener('input', POWERMODE);
</script><script id="click-heart" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/click-heart.min.js" async="async" mobile="true"></script><script>((window.gitter = {}).chat = {}).options = {
  disableDefaultChat: true,
};
document.addEventListener('gitter-sidecar-ready', (e) => {
  const GitterChat = e.detail.Chat
  let chat

  function initGitter () {
    chat = new GitterChat({
      room: 'QianChengGitBlog/QianChengGitBlogRoom',
      activationElement: '#chat_btn'
    });
  }

  initGitter()

  if (false) {
    document.addEventListener('pjax:complete', () => {
      chat.destroy()
      initGitter()
    })
  }

})</script><script src="https://sidecar.gitter.im/dist/sidecar.v1.js" async="async" defer="defer"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><!-- hexo injector body_end start --><script>
    // 全局变量声明区域
    var fdata = {
      apiurl: 'https://hexo-friendcircle3-api-sigma.vercel.app/api',
      initnumber: 20, //【可选】页面初始化展示文章数量
      stepnumber: 10, //【可选】每次加载增加的篇数
      error_img: 'https://cdn.jsdelivr.net/npm/akilar-candyassets/image/404.gif' //【可选，头像图片加载失败时的默认头像】
    }
    //存入本地存储
    localStorage.setItem("fdatalist",JSON.stringify(fdata))
    </script>
    <script defer src="https://cdn.jsdelivr.net/npm/hexo-filter-fcircle/assets/js/fetch.min.js"></script><script data-pjax>
  function butterfly_footer_beautify_injector_config(){
    var parent_div_git = document.getElementById('footer-wrap');
    var item_html = '<div id="workboard"></div><div id="ghbdages" style="overflow:hidden;max-height:90px;height:auto;text-align:center;margin-top:10px"><div class="swiper-wrapper"><div class="swiper-slide"><a class="github-badge" target="_blank" href="https://hexo.io/" style="margin-inline:5px" title="博客框架为Hexo_v5.4.0"><img src="https://img.shields.io/badge/Frame-Hexo-blue?style=flat&amp;logo=hexo" alt=""/></a><a class="github-badge" target="_blank" href="https://butterfly.js.org/" style="margin-inline:5px" title="主题版本Butterfly_v3.6.2"><img src="https://img.shields.io/badge/Theme-Butterfly-6513df?style=flat&amp;logo=bitdefender" alt=""/></a><a class="github-badge" target="_blank" href="https://www.jsdelivr.com/" style="margin-inline:5px" title="本站使用JsDelivr为静态资源提供CDN加速"><img src="https://img.shields.io/badge/CDN-jsDelivr-orange?style=flat&amp;logo=jsDelivr" alt=""/></a></div><div class="swiper-slide"><a class="github-badge" target="_blank" href="https://github.com/" style="margin-inline:5px" title="本站项目由Gtihub托管"><img src="https://img.shields.io/badge/Source-Github-d021d6?style=flat&amp;logo=GitHub" alt=""/></a><a class="github-badge" target="_blank" href="http://creativecommons.org/licenses/by-nc-sa/4.0/" style="margin-inline:5px" title="本站采用知识共享署名-非商业性使用-相同方式共享4.0国际许可协议进行许可"><img src="https://img.shields.io/badge/Copyright-BY--NC--SA%204.0-d42328?style=flat&amp;logo=Claris" alt=""/></a></div></div></div><style>a.github-badge:hover:before {display:none}</style>';
    console.log('已挂载butterfly_footer_beautify')
    parent_div_git.insertAdjacentHTML("beforeend",item_html)
    }
  var elist = 'null'.split(',');
  var cpage = location.pathname;
  var epage = 'all';
  var flag = 0;

  for (var i=0;i<elist.length;i++){
    if (cpage.includes(elist[i])){
      flag++;
    }
  }

  if ((epage ==='all')&&(flag == 0)){
    butterfly_footer_beautify_injector_config();
  }
  else if (epage === cpage){
    butterfly_footer_beautify_injector_config();
  }
  </script><script async src="/js/runtime.js"></script><script defer src="https://cdn.jsdelivr.net/npm/hexo-butterfly-swiper/lib/swiper.min.js"></script><script defer data-pjax src="https://cdn.jsdelivr.net/npm/hexo-butterfly-footer-beautify/lib/swiperbdage_init.min.js"></script><script data-pjax>
  function butterfly_swiper_injector_config(){
    var parent_div_git = document.getElementById('recent-posts');
    var item_html = '<div class="recent-post-item" style="height: auto;width: 100%"><div class="blog-slider swiper-container-fade swiper-container-horizontal" id="swiper_container"><div class="blog-slider__wrp swiper-wrapper" style="transition-duration: 0ms;"><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="2021/10/04/Butterfly主题安装魔改日志文档/" alt=""><img width="48" height="48" src="https://i.loli.net/2021/03/07/HoXI7C2NtdguaBw.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2021-10-04</span><a class="blog-slider__title" href="2021/10/04/Butterfly主题安装魔改日志文档/" alt="">Butterfly主题安装魔改日志文档</a><div class="blog-slider__text">Butterfly主题安装魔改日志文档，升级主题方便找到回家的路</div><a class="blog-slider__button" href="2021/10/04/Butterfly主题安装魔改日志文档/" alt="">详情   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="2022/09/04/SpringBoot集成JWT/" alt=""><img width="48" height="48" src="https://i.loli.net/2021/03/07/HoXI7C2NtdguaBw.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2022-09-04</span><a class="blog-slider__title" href="2022/09/04/SpringBoot集成JWT/" alt="">SpringBoot集成JWT</a><div class="blog-slider__text">学习SpringBoot集成JWT。</div><a class="blog-slider__button" href="2022/09/04/SpringBoot集成JWT/" alt="">详情   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="2021/05/10/springboot整合Mybatis（注解方式）/" alt=""><img width="48" height="48" src="https://i.loli.net/2021/03/07/HoXI7C2NtdguaBw.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2021-05-10</span><a class="blog-slider__title" href="2021/05/10/springboot整合Mybatis（注解方式）/" alt="">springboot整合MyBatis（注解方式）</a><div class="blog-slider__text">学习springboot应用整合MyBatis</div><a class="blog-slider__button" href="2021/05/10/springboot整合Mybatis（注解方式）/" alt="">详情   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="2022/09/02/SpringBoot整合Hutool实现Excel导入导出/" alt=""><img width="48" height="48" src="https://i.loli.net/2021/03/07/HoXI7C2NtdguaBw.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2022-09-02</span><a class="blog-slider__title" href="2022/09/02/SpringBoot整合Hutool实现Excel导入导出/" alt="">SpringBoot整合Hutool实现Excel导入导出</a><div class="blog-slider__text">学习springboot使用Hutool实现Excel导入导出。</div><a class="blog-slider__button" href="2022/09/02/SpringBoot整合Hutool实现Excel导入导出/" alt="">详情   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="2022/08/25/SpringBoot整合Swagger-UI/" alt=""><img width="48" height="48" src="https://i.loli.net/2021/03/07/HoXI7C2NtdguaBw.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2022-08-25</span><a class="blog-slider__title" href="2022/08/25/SpringBoot整合Swagger-UI/" alt="">springboot整合Swagger-UI 3.0</a><div class="blog-slider__text">学习springboot整合Swagger-UI 3.0。</div><a class="blog-slider__button" href="2022/08/25/SpringBoot整合Swagger-UI/" alt="">详情   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="2022/08/29/SpringBoot整合MyBatis-Plus代码生成器/" alt=""><img width="48" height="48" src="https://i.loli.net/2021/03/07/HoXI7C2NtdguaBw.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2022-08-29</span><a class="blog-slider__title" href="2022/08/29/SpringBoot整合MyBatis-Plus代码生成器/" alt="">springboot使用MyBatis-Plus代码生成器</a><div class="blog-slider__text">学习springboot使用MyBatis-Plus代码生成器。</div><a class="blog-slider__button" href="2022/08/29/SpringBoot整合MyBatis-Plus代码生成器/" alt="">详情   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="2022/08/24/SpringBoot整合MyBatis-Plus/" alt=""><img width="48" height="48" src="https://i.loli.net/2021/03/07/HoXI7C2NtdguaBw.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2022-08-24</span><a class="blog-slider__title" href="2022/08/24/SpringBoot整合MyBatis-Plus/" alt="">springboot整合MyBatis-Plus</a><div class="blog-slider__text">学习springboot整合MyBatis-Plus。</div><a class="blog-slider__button" href="2022/08/24/SpringBoot整合MyBatis-Plus/" alt="">详情   </a></div></div></div><div class="blog-slider__pagination swiper-pagination-clickable swiper-pagination-bullets"></div></div></div>';
    console.log('已挂载butterfly_swiper')
    parent_div_git.insertAdjacentHTML("afterbegin",item_html)
    }
  var elist = 'undefined'.split(',');
  var cpage = location.pathname;
  var epage = '/';
  var flag = 0;

  for (var i=0;i<elist.length;i++){
    if (cpage.includes(elist[i])){
      flag++;
    }
  }

  if ((epage ==='all')&&(flag == 0)){
    butterfly_swiper_injector_config();
  }
  else if (epage === cpage){
    butterfly_swiper_injector_config();
  }
  </script><script defer src="https://npm.elemecdn.com/hexo-butterfly-swiper/lib/swiper.min.js"></script><script defer data-pjax src="https://npm.elemecdn.com/hexo-butterfly-swiper/lib/swiper_init.js"></script><div class="js-pjax"><script async="async">var arr = document.getElementsByClassName('recent-post-item');
for(var i = 0;i<arr.length;i++){
    arr[i].classList.add('wow');
    arr[i].classList.add('animate__zoomIn');
    arr[i].setAttribute('data-wow-duration', '1s');
    arr[i].setAttribute('data-wow-delay', '500ms');
    arr[i].setAttribute('data-wow-offset', '100');
    arr[i].setAttribute('data-wow-iteration', '1');
  }</script><script async="async">var arr = document.getElementsByClassName('card-widget');
for(var i = 0;i<arr.length;i++){
    arr[i].classList.add('wow');
    arr[i].classList.add('animate__zoomIn');
    arr[i].setAttribute('data-wow-duration', '');
    arr[i].setAttribute('data-wow-delay', '');
    arr[i].setAttribute('data-wow-offset', '');
    arr[i].setAttribute('data-wow-iteration', '');
  }</script></div><script defer src="https://cdn.jsdelivr.net/gh/graingert/wow@1.3.0/dist/wow.min.js"></script><script defer src="https://cdn.jsdelivr.net/npm/hexo-butterfly-wowjs/lib/wow_init.min.js"></script>
  <script data-pjax src="https://cdn.jsdelivr.net/gh/Zfour/hexo-github-calendar@1.16/hexo_githubcalendar.js"></script>
  <script data-pjax>
        function GithubCalendarConfig(){
            var git_githubapiurl ="https://gitcalendar.zfe.space/api?QianChengGit";
            var git_color =['#ebedf0', '#80ff74', '#60ff51', '#4dfc3e', '#28ff15', '#13e600', '#12d600', '#10c000', '#0da000', '#0d8302', '#085c00'];
            var git_user ="QianChengGit";
            var parent_div_git = document.getElementById('recent-posts');
            var git_div_html = '<div class="recent-post-item" style="width:100%;height:auto;padding:10px;"><div id="github_loading" style="width:10%;height:100%;margin:0 auto;display: block"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"  viewBox="0 0 50 50" style="enable-background:new 0 0 50 50" xml:space="preserve"><path fill="#d0d0d0" d="M25.251,6.461c-10.318,0-18.683,8.365-18.683,18.683h4.068c0-8.071,6.543-14.615,14.615-14.615V6.461z" transform="rotate(275.098 25 25)"><animateTransform attributeType="xml" attributeName="transform" type="rotate" from="0 25 25" to="360 25 25" dur="0.6s" repeatCount="indefinite"></animateTransform></path></svg></div><div id="github_container"></div></div>';
            if(parent_div_git && location.pathname =='/'){
                console.log('已挂载github calendar')
                // parent_div_git.innerHTML=git_div_html+parent_div_git.innerHTML // 无报错，但不影响使用(支持pjax跳转)
                parent_div_git.insertAdjacentHTML("afterbegin",git_div_html) // 有报错，但不影响使用(支持pjax跳转)
            };
            GithubCalendar(git_githubapiurl,git_color,git_user)
        }
        if(document.getElementById('recent-posts')){
            GithubCalendarConfig()
        }
    </script>
    <style>#github_container{min-height:280px}@media screen and (max-width:650px) {#github_container{background-image:;min-height:0px}}</style>
    <style></style><!-- hexo injector body_end end --></body></html>